<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Grisbi:  Fichier source de bet_data.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Généré par Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Page&nbsp;principale</span></a></li>
      <li><a href="pages.html"><span>Pages&nbsp;associées</span></a></li>
      <li><a href="annotated.html"><span>Structures&nbsp;de&nbsp;données</span></a></li>
      <li class="current"><a href="files.html"><span>Fichiers</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>Liste&nbsp;des&nbsp;fichiers</span></a></li>
      <li><a href="globals.html"><span>Portée&nbsp;globale</span></a></li>
    </ul>
  </div>
<h1>bet_data.c</h1><a href="bet__data_8c.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* ************************************************************************** */</span>
<a name="l00002"></a>00002 <span class="comment">/*                                                                            */</span>
<a name="l00003"></a>00003 <span class="comment">/*     Copyright (C) 2007 Dominique Parisot                                   */</span>
<a name="l00004"></a>00004 <span class="comment">/*          zionly@free.org                                                   */</span>
<a name="l00005"></a>00005 <span class="comment">/*          2008-2010 Pierre Biava (grisbi@pierre.biava.name)                 */</span>
<a name="l00006"></a>00006 <span class="comment">/*          http://www.grisbi.org                                             */</span>
<a name="l00007"></a>00007 <span class="comment">/*                                                                            */</span>
<a name="l00008"></a>00008 <span class="comment">/*  This program is free software; you can redistribute it and/or modify      */</span>
<a name="l00009"></a>00009 <span class="comment">/*  it under the terms of the GNU General Public License as published by      */</span>
<a name="l00010"></a>00010 <span class="comment">/*  the Free Software Foundation; either version 2 of the License, or         */</span>
<a name="l00011"></a>00011 <span class="comment">/*  (at your option) any later version.                                       */</span>
<a name="l00012"></a>00012 <span class="comment">/*                                                                            */</span>
<a name="l00013"></a>00013 <span class="comment">/*  This program is distributed in the hope that it will be useful,           */</span>
<a name="l00014"></a>00014 <span class="comment">/*  but WITHOUT ANY WARRANTY; without even the implied warranty of            */</span>
<a name="l00015"></a>00015 <span class="comment">/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the             */</span>
<a name="l00016"></a>00016 <span class="comment">/*  GNU General Public License for more details.                              */</span>
<a name="l00017"></a>00017 <span class="comment">/*                                                                            */</span>
<a name="l00018"></a>00018 <span class="comment">/*  You should have received a copy of the GNU General Public License         */</span>
<a name="l00019"></a>00019 <span class="comment">/*  along with this program; if not, write to the Free Software               */</span>
<a name="l00020"></a>00020 <span class="comment">/*  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA */</span>
<a name="l00021"></a>00021 <span class="comment">/*                                                                            */</span>
<a name="l00022"></a>00022 <span class="comment">/* ************************************************************************** */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">/* ./configure --with-balance-estimate */</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="include_8h.html">include.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;config.h&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">/*START_INCLUDE*/</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="bet__data_8h.html">bet_data.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="bet__hist_8h.html">bet_hist.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="bet__tab_8h.html">bet_tab.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="dialog_8h.html">dialog.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="fenetre__principale_8h.html">fenetre_principale.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="gsb__data__account_8h.html">gsb_data_account.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="gsb__data__budget_8h.html">gsb_data_budget.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="gsb__data__category_8h.html">gsb_data_category.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="gsb__data__mix_8h.html">gsb_data_mix.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="gsb__data__transaction_8h.html">gsb_data_transaction.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="utils__dates_8h.html">utils_dates.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="navigation_8h.html">navigation.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="traitement__variables_8h.html">traitement_variables.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="gsb__file__save_8h.html">gsb_file_save.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="utils__str_8h.html">utils_str.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="gsb__data__account_8h.html">gsb_data_account.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="gsb__scheduler__list_8h.html">gsb_scheduler_list.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="erreur_8h.html">erreur.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="structures_8h.html">structures.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="comment">/*END_INCLUDE*/</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">/*START_STATIC*/</span>
<a name="l00053"></a>00053 <span class="keyword">static</span> GDate *bet_data_futur_get_next_date ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled,
<a name="l00054"></a>00054                         <span class="keyword">const</span> GDate *date,
<a name="l00055"></a>00055                         <span class="keyword">const</span> GDate *date_max );
<a name="l00056"></a>00056 <span class="keyword">static</span> <a class="code" href="struct__future__data.html">struct_futur_data</a> *bet_data_future_copy_struct ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled );
<a name="l00057"></a>00057 <span class="keyword">static</span> <span class="keywordtype">void</span> bet_data_future_set_max_number ( gint number );
<a name="l00058"></a>00058 <span class="keyword">static</span> gboolean bet_data_update_div ( <a class="code" href="struct__historical.html">SH</a> *sh, gint transaction_number, gint sub_div );
<a name="l00059"></a>00059 <span class="keyword">static</span> <span class="keywordtype">void</span> struct_free_bet_future ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled );
<a name="l00060"></a>00060 <span class="keyword">static</span> <span class="keywordtype">void</span> struct_free_bet_range ( <a class="code" href="struct__bet__range.html">SBR</a> *sbr );
<a name="l00061"></a>00061 <span class="keyword">static</span> <span class="keywordtype">void</span> struct_free_bet_transfert ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert );
<a name="l00062"></a>00062 <span class="keyword">static</span> <span class="keywordtype">void</span> struct_free_hist_div ( <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd );
<a name="l00063"></a>00063 <span class="keyword">static</span> <a class="code" href="struct__historical.html">SH</a> *struct_initialise_bet_historical ( <span class="keywordtype">void</span> );
<a name="l00064"></a>00064 <span class="comment">/*END_STATIC*/</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/*START_EXTERN*/</span>
<a name="l00068"></a>00068 <span class="keyword">extern</span> GtkWidget *<a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a>;
<a name="l00069"></a>00069 <span class="keyword">extern</span> GtkWidget *<a class="code" href="bet__config_8c.html#a8924516aa4170f932308e93cf93a785b">notebook_general</a>;
<a name="l00070"></a>00070 <span class="keyword">extern</span> <a class="code" href="structgsb__real.html">gsb_real</a> <a class="code" href="accueil_8c.html#a26f304bec3fdc0651b9aa8765d4de3c6">null_real</a>;
<a name="l00071"></a>00071 <span class="comment">/*END_EXTERN*/</span>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">/* pointeurs définis en fonction du type de données catégories ou IB */</span>
<a name="l00075"></a><a class="code" href="bet__data_8c.html#a30c03a279ce8440557b96c66cee7dfeb">00075</a> gint (*<a class="code" href="bet__data_8c.html#a30c03a279ce8440557b96c66cee7dfeb">ptr_div</a>) ( gint transaction_num, gboolean is_transaction );
<a name="l00076"></a><a class="code" href="bet__data_8c.html#aef277c7a40bd87dddd1debe83ce337bf">00076</a> gint (*<a class="code" href="bet__data_8c.html#aef277c7a40bd87dddd1debe83ce337bf">ptr_sub_div</a>) ( gint transaction_num, gboolean is_transaction );
<a name="l00077"></a><a class="code" href="bet__data_8c.html#a932f6d02883ab21b24a201e03911aaf2">00077</a> gint (*<a class="code" href="bet__data_8c.html#a932f6d02883ab21b24a201e03911aaf2">ptr_type</a>) ( gint no_div );
<a name="l00078"></a><a class="code" href="bet__data_8c.html#a077bff3a3e81222d14f90c23c886e99c">00078</a> gchar* (*ptr_div_name) ( gint div_num, gint sub_div, <span class="keyword">const</span> gchar *return_value_error );
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/* liste des div et sub_div cochées dans la vue des divisions */</span>
<a name="l00082"></a>00082 <span class="keyword">static</span> GHashTable *bet_hist_div_list;
<a name="l00083"></a>00083 
<a name="l00085"></a>00085 <span class="keyword">static</span> GHashTable *bet_future_list;
<a name="l00086"></a>00086 <span class="keyword">static</span> gint future_number;
<a name="l00087"></a>00087 
<a name="l00089"></a>00089 <span class="keyword">static</span> GHashTable *bet_transfert_list;
<a name="l00090"></a>00090 <span class="keyword">static</span> gint transfert_number;
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 
<a name="l00097"></a><a class="code" href="bet__data_8h.html#a1056a006e9aa525d168c86363029d44e">00097</a> <span class="keywordtype">void</span> <a class="code" href="bet__data_8c.html#a1056a006e9aa525d168c86363029d44e">bet_data_select_bet_pages</a> ( gint account_number )
<a name="l00098"></a>00098 {
<a name="l00099"></a>00099     GtkWidget *page;
<a name="l00100"></a>00100     GtkWidget *tree_view;
<a name="l00101"></a>00101     <a class="code" href="gsb__data__account_8h.html#abe336abc6aaa13733b0ea311c9478862">kind_account</a> kind;
<a name="l00102"></a>00102     gint current_page;
<a name="l00103"></a>00103     gint bet_use_budget;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     <a class="code" href="erreur_8h.html#a10f4eeae4cc251a8d632fd62ec1057fb">devel_debug_int</a> ( account_number );
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     kind = <a class="code" href="gsb__data__account_8c.html#aa2e978644e71d62a1aaf1c58cb6b0fcd">gsb_data_account_get_kind</a> ( account_number );
<a name="l00108"></a>00108     current_page = gtk_notebook_get_current_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ) );
<a name="l00109"></a>00109     bet_use_budget = <a class="code" href="gsb__data__account_8c.html#a45f96754e58262d87cb7bda9c04219ce">gsb_data_account_get_bet_use_budget</a> ( account_number );
<a name="l00110"></a>00110     <span class="keywordflow">if</span> ( bet_use_budget &lt;= 0 )
<a name="l00111"></a>00111         kind = <a class="code" href="gsb__data__account_8h.html#ab5b2ad5b1ac065827dcf65b09542f53dadc037542033019363481655361e31a82">GSB_TYPE_ASSET</a>;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     tree_view = g_object_get_data ( G_OBJECT ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <span class="stringliteral">&quot;bet_estimate_treeview&quot;</span> );
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <span class="keywordflow">switch</span> ( kind )
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117     <span class="keywordflow">case</span> <a class="code" href="gsb__data__account_8h.html#ab5b2ad5b1ac065827dcf65b09542f53da718d20004be845980da235b81c70f72a">GSB_TYPE_BANK</a>:
<a name="l00118"></a>00118         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> );
<a name="l00119"></a>00119         gtk_widget_show ( page );
<a name="l00120"></a>00120         <a class="code" href="bet__tab_8c.html#ad6a44874943998f49cc24bda305c961b">bet_array_list_select_path</a> ( tree_view, NULL );
<a name="l00121"></a>00121         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a90dc66bf685d88710b5f31dec284ca60">GSB_HISTORICAL_PAGE</a> );
<a name="l00122"></a>00122         gtk_widget_show ( page );
<a name="l00123"></a>00123         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ae293458cd4959e914140e844db3e3cd7">GSB_FINANCE_PAGE</a> );
<a name="l00124"></a>00124         gtk_widget_hide ( page );
<a name="l00125"></a>00125         <a class="code" href="bet__hist_8c.html#abdc34191d350f48a5dfa2aab50e813d5">bet_historical_g_signal_unblock_tree_view</a> ( );
<a name="l00126"></a>00126         <a class="code" href="gsb__data__account_8c.html#aad11cfab16ac44e8de3dd6d792fce4cd">gsb_data_account_set_bet_maj</a> ( account_number, <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400a9d574c71c6a04cadf85be9083be54eed">BET_MAJ_ALL</a> );
<a name="l00127"></a>00127         <span class="keywordflow">if</span> ( current_page &lt; <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a45c82e5bce0145d1fa7756bd8d1776af">GSB_PROPERTIES_PAGE</a> 
<a name="l00128"></a>00128          &amp;&amp; 
<a name="l00129"></a>00129          <a class="code" href="gsb__data__account_8c.html#a45f96754e58262d87cb7bda9c04219ce">gsb_data_account_get_bet_use_budget</a> ( account_number ) == FALSE )
<a name="l00130"></a>00130             gtk_notebook_set_current_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ab1e1afd5860f84ec3b2434c16e8d661e">GSB_TRANSACTIONS_PAGE</a> );
<a name="l00131"></a>00131         <span class="keywordflow">if</span> ( current_page == <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ae293458cd4959e914140e844db3e3cd7">GSB_FINANCE_PAGE</a> )
<a name="l00132"></a>00132             gtk_notebook_set_current_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> );
<a name="l00133"></a>00133         <span class="keywordflow">break</span>;
<a name="l00134"></a>00134     <span class="keywordflow">case</span> <a class="code" href="gsb__data__account_8h.html#ab5b2ad5b1ac065827dcf65b09542f53da1e355ad8c560d892d0b5912be1d875a2">GSB_TYPE_CASH</a>:
<a name="l00135"></a>00135         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> );
<a name="l00136"></a>00136         gtk_widget_hide ( page );
<a name="l00137"></a>00137         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a90dc66bf685d88710b5f31dec284ca60">GSB_HISTORICAL_PAGE</a> );
<a name="l00138"></a>00138         gtk_widget_show ( page );
<a name="l00139"></a>00139         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ae293458cd4959e914140e844db3e3cd7">GSB_FINANCE_PAGE</a> );
<a name="l00140"></a>00140         gtk_widget_hide ( page );
<a name="l00141"></a>00141         <span class="keywordflow">if</span> ( current_page == <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> || current_page == <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ae293458cd4959e914140e844db3e3cd7">GSB_FINANCE_PAGE</a> )
<a name="l00142"></a>00142             gtk_notebook_set_current_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a90dc66bf685d88710b5f31dec284ca60">GSB_HISTORICAL_PAGE</a> );
<a name="l00143"></a>00143         <a class="code" href="bet__hist_8c.html#adf6e0f9c8fad1ccf20cf59f847952694">bet_historical_g_signal_block_tree_view</a> ( );
<a name="l00144"></a>00144         <a class="code" href="gsb__data__account_8c.html#aad11cfab16ac44e8de3dd6d792fce4cd">gsb_data_account_set_bet_maj</a> ( account_number, <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400acf2c8b517c4d30e79bfe2e8b6b5400c5">BET_MAJ_HISTORICAL</a> );
<a name="l00145"></a>00145         <span class="keywordflow">break</span>;
<a name="l00146"></a>00146     <span class="keywordflow">case</span> <a class="code" href="gsb__data__account_8h.html#ab5b2ad5b1ac065827dcf65b09542f53dad80fd01815f2d74aecc46cad959a3da9">GSB_TYPE_LIABILITIES</a>:
<a name="l00147"></a>00147         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> );
<a name="l00148"></a>00148         gtk_widget_hide ( page );
<a name="l00149"></a>00149         <a class="code" href="bet__tab_8c.html#ad6a44874943998f49cc24bda305c961b">bet_array_list_select_path</a> ( tree_view, NULL );
<a name="l00150"></a>00150         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a90dc66bf685d88710b5f31dec284ca60">GSB_HISTORICAL_PAGE</a> );
<a name="l00151"></a>00151         gtk_widget_hide ( page );
<a name="l00152"></a>00152         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ae293458cd4959e914140e844db3e3cd7">GSB_FINANCE_PAGE</a> );
<a name="l00153"></a>00153         gtk_widget_show ( page );
<a name="l00154"></a>00154         <span class="keywordflow">if</span> ( current_page == <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> || current_page == <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a90dc66bf685d88710b5f31dec284ca60">GSB_HISTORICAL_PAGE</a> )
<a name="l00155"></a>00155             gtk_notebook_set_current_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ae293458cd4959e914140e844db3e3cd7">GSB_FINANCE_PAGE</a> );
<a name="l00156"></a>00156         <span class="keywordflow">break</span>;
<a name="l00157"></a>00157     <span class="keywordflow">case</span> <a class="code" href="gsb__data__account_8h.html#ab5b2ad5b1ac065827dcf65b09542f53dadc037542033019363481655361e31a82">GSB_TYPE_ASSET</a>:
<a name="l00158"></a>00158         <span class="keywordflow">if</span> ( current_page &lt; <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a45c82e5bce0145d1fa7756bd8d1776af">GSB_PROPERTIES_PAGE</a> )
<a name="l00159"></a>00159             gtk_notebook_set_current_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ab1e1afd5860f84ec3b2434c16e8d661e">GSB_TRANSACTIONS_PAGE</a> );
<a name="l00160"></a>00160         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> );
<a name="l00161"></a>00161         gtk_widget_hide ( page );
<a name="l00162"></a>00162         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a90dc66bf685d88710b5f31dec284ca60">GSB_HISTORICAL_PAGE</a> );
<a name="l00163"></a>00163         gtk_widget_hide ( page );
<a name="l00164"></a>00164         page = gtk_notebook_get_nth_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ), <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520ae293458cd4959e914140e844db3e3cd7">GSB_FINANCE_PAGE</a> );
<a name="l00165"></a>00165         gtk_widget_hide ( page );
<a name="l00166"></a>00166         <span class="keywordflow">break</span>;
<a name="l00167"></a>00167     }
<a name="l00168"></a>00168 }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">/*</span>
<a name="l00172"></a>00172 <span class="comment"> * Met à jour les données à afficher dans les différentes vues du module</span>
<a name="l00173"></a>00173 <span class="comment"> *</span>
<a name="l00174"></a>00174 <span class="comment"> * </span>
<a name="l00175"></a>00175 <span class="comment"> */</span>
<a name="l00176"></a><a class="code" href="bet__data_8h.html#af0bc501a6a7a255f8adc9500328c950f">00176</a> <span class="keywordtype">void</span> <a class="code" href="bet__data_8c.html#af0bc501a6a7a255f8adc9500328c950f">bet_data_update_bet_module</a> ( gint account_number, guint page )
<a name="l00177"></a>00177 {
<a name="l00178"></a>00178     gint type_maj;
<a name="l00179"></a>00179     <a class="code" href="gsb__data__account_8h.html#abe336abc6aaa13733b0ea311c9478862">kind_account</a> kind;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <a class="code" href="erreur_8h.html#a10f4eeae4cc251a8d632fd62ec1057fb">devel_debug_int</a> ( account_number );
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <span class="comment">/* test account number */</span>
<a name="l00184"></a>00184     <span class="keywordflow">if</span> ( account_number == -1 )
<a name="l00185"></a>00185         <span class="keywordflow">return</span>;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187     type_maj = <a class="code" href="gsb__data__account_8c.html#acfd5b571d1eb8c55b20440bc4b584baf">gsb_data_account_get_bet_maj</a> ( account_number );
<a name="l00188"></a>00188     <span class="keywordflow">if</span> ( type_maj == <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400a85b2c3349ecc04524add7ae231787dbc">BET_MAJ_FALSE</a> )
<a name="l00189"></a>00189         <span class="keywordflow">return</span>;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191     kind = <a class="code" href="gsb__data__account_8c.html#aa2e978644e71d62a1aaf1c58cb6b0fcd">gsb_data_account_get_kind</a> ( account_number );
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     <span class="keywordflow">if</span> ( page == -1 &amp;&amp; <a class="code" href="navigation_8c.html#a06fa2882a164439e56e780c2127cd22c">gsb_gui_navigation_get_current_page</a> ( ) == <a class="code" href="fenetre__principale_8h.html#a1667fdc1081851887c24c98c97d51767aa0842b1ab75cc108643f94f240f11905">GSB_ACCOUNT_PAGE</a> )
<a name="l00195"></a>00195         page = gtk_notebook_get_current_page ( GTK_NOTEBOOK ( <a class="code" href="bet__config_8c.html#ad5443d986a9ab5d64dd84c5346c4b87c">account_page</a> ) );
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     <span class="keywordflow">switch</span> ( page )
<a name="l00198"></a>00198     {
<a name="l00199"></a>00199         <span class="keywordflow">case</span> <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a>:
<a name="l00200"></a>00200             <a class="code" href="bet__tab_8c.html#a333b7b726d6915f02a6a8bb93365046b">bet_array_update_estimate_tab</a> ( account_number, type_maj );
<a name="l00201"></a>00201             <a class="code" href="gsb__data__account_8c.html#aad11cfab16ac44e8de3dd6d792fce4cd">gsb_data_account_set_bet_maj</a> ( account_number, <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400a85b2c3349ecc04524add7ae231787dbc">BET_MAJ_FALSE</a> );
<a name="l00202"></a>00202             <span class="keywordflow">break</span>;
<a name="l00203"></a>00203         <span class="keywordflow">case</span> <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a90dc66bf685d88710b5f31dec284ca60">GSB_HISTORICAL_PAGE</a>:
<a name="l00204"></a>00204             <span class="keywordflow">if</span> ( type_maj == <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400a9d574c71c6a04cadf85be9083be54eed">BET_MAJ_ALL</a> )
<a name="l00205"></a>00205             {
<a name="l00206"></a>00206                 <a class="code" href="bet__hist_8c.html#adc9c988a689a8786009b652946cafd79">bet_historical_populate_data</a> ( account_number );
<a name="l00207"></a>00207                 <a class="code" href="gsb__data__account_8c.html#aad11cfab16ac44e8de3dd6d792fce4cd">gsb_data_account_set_bet_maj</a> ( account_number, <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400a8c9b47440bdc426dc6e11af2b2856792">BET_MAJ_ESTIMATE</a> );
<a name="l00208"></a>00208             }
<a name="l00209"></a>00209             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( type_maj ==  <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400acf2c8b517c4d30e79bfe2e8b6b5400c5">BET_MAJ_HISTORICAL</a> )
<a name="l00210"></a>00210             {
<a name="l00211"></a>00211                 <a class="code" href="bet__hist_8c.html#adc9c988a689a8786009b652946cafd79">bet_historical_populate_data</a> ( account_number );
<a name="l00212"></a>00212                 <a class="code" href="gsb__data__account_8c.html#aad11cfab16ac44e8de3dd6d792fce4cd">gsb_data_account_set_bet_maj</a> ( account_number, <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400a85b2c3349ecc04524add7ae231787dbc">BET_MAJ_FALSE</a> );
<a name="l00213"></a>00213             }
<a name="l00214"></a>00214             <span class="keywordflow">break</span>;
<a name="l00215"></a>00215         <span class="keywordflow">default</span>:
<a name="l00216"></a>00216             <span class="keywordflow">break</span>;
<a name="l00217"></a>00217     }
<a name="l00218"></a>00218 }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 
<a name="l00228"></a><a class="code" href="bet__data_8h.html#ac36863d207e1ef101c501a31760e67a1">00228</a> gboolean <a class="code" href="bet__data_8c.html#ac36863d207e1ef101c501a31760e67a1">bet_data_init_variables</a> ( <span class="keywordtype">void</span> )
<a name="l00229"></a>00229 {
<a name="l00230"></a>00230     bet_hist_div_list = g_hash_table_new_full ( g_str_hash,
<a name="l00231"></a>00231                         g_str_equal,
<a name="l00232"></a>00232                         (GDestroyNotify) g_free,
<a name="l00233"></a>00233                         (GDestroyNotify) struct_free_hist_div );
<a name="l00234"></a>00234     bet_future_list = g_hash_table_new_full ( g_str_hash,
<a name="l00235"></a>00235                         g_str_equal,
<a name="l00236"></a>00236                         (GDestroyNotify) g_free,
<a name="l00237"></a>00237                         (GDestroyNotify) struct_free_bet_future );
<a name="l00238"></a>00238     future_number = 0;
<a name="l00239"></a>00239 
<a name="l00240"></a>00240     bet_transfert_list = g_hash_table_new_full ( g_str_hash,
<a name="l00241"></a>00241                         g_str_equal,
<a name="l00242"></a>00242                         (GDestroyNotify) g_free,
<a name="l00243"></a>00243                         (GDestroyNotify) struct_free_bet_transfert );
<a name="l00244"></a>00244     transfert_number = 0;
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     <span class="keywordflow">return</span> FALSE;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 
<a name="l00256"></a><a class="code" href="bet__data_8h.html#a8e4e124545cf8a530c9c3ad879bcf5ea">00256</a> gboolean <a class="code" href="bet__data_8c.html#a8e4e124545cf8a530c9c3ad879bcf5ea">bet_data_hist_add_div</a> ( gint account_nb,
<a name="l00257"></a>00257                         gint div_number,
<a name="l00258"></a>00258                         gint sub_div_nb )
<a name="l00259"></a>00259 {
<a name="l00260"></a>00260     gchar *key;
<a name="l00261"></a>00261     gchar *sub_key;
<a name="l00262"></a>00262     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <span class="keywordflow">if</span> ( account_nb == 0 )
<a name="l00265"></a>00265         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00266"></a>00266     <span class="keywordflow">else</span>
<a name="l00267"></a>00267         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( account_nb ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l00268"></a>00268                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00269"></a>00269 
<a name="l00270"></a>00270     <span class="keywordflow">if</span> ( ( shd = g_hash_table_lookup ( bet_hist_div_list, key ) ) )
<a name="l00271"></a>00271     {
<a name="l00272"></a>00272         shd -&gt; div_edited = FALSE;
<a name="l00273"></a>00273         shd -&gt; amount = null_real;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         <span class="keywordflow">if</span> ( sub_div_nb &gt; 0 )
<a name="l00276"></a>00276         {
<a name="l00277"></a>00277             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div_nb );
<a name="l00278"></a>00278             <span class="keywordflow">if</span> (  !g_hash_table_lookup ( shd -&gt; sub_div_list, sub_key ) )
<a name="l00279"></a>00279             {
<a name="l00280"></a>00280                 <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282                 sub_shd = <a class="code" href="bet__data_8c.html#a02747f493a512f416e05204ef14f6925">struct_initialise_hist_div</a> ( );
<a name="l00283"></a>00283                 <span class="keywordflow">if</span> ( !sub_shd )
<a name="l00284"></a>00284                 {
<a name="l00285"></a>00285                     <a class="code" href="dialog_8c.html#abb50e706a2eedd167eeb63d2de9c1245">dialogue_error_memory</a> ( );
<a name="l00286"></a>00286                     <span class="keywordflow">return</span> FALSE;
<a name="l00287"></a>00287                 }
<a name="l00288"></a>00288                 sub_shd -&gt; div_number = sub_div_nb;
<a name="l00289"></a>00289                 g_hash_table_insert ( shd -&gt; sub_div_list, sub_key, sub_shd );
<a name="l00290"></a>00290             }
<a name="l00291"></a>00291             <span class="keywordflow">else</span>
<a name="l00292"></a>00292             {
<a name="l00293"></a>00293                 shd -&gt; div_edited = FALSE;
<a name="l00294"></a>00294                 shd -&gt; amount = null_real;
<a name="l00295"></a>00295             }
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298     <span class="keywordflow">else</span>
<a name="l00299"></a>00299     {
<a name="l00300"></a>00300         shd = <a class="code" href="bet__data_8c.html#a02747f493a512f416e05204ef14f6925">struct_initialise_hist_div</a> ( );
<a name="l00301"></a>00301         <span class="keywordflow">if</span> ( !shd )
<a name="l00302"></a>00302         {
<a name="l00303"></a>00303             <a class="code" href="dialog_8c.html#abb50e706a2eedd167eeb63d2de9c1245">dialogue_error_memory</a> ( );
<a name="l00304"></a>00304             <span class="keywordflow">return</span> 0;
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306         shd -&gt; account_nb = account_nb;
<a name="l00307"></a>00307         shd -&gt; div_number = div_number;
<a name="l00308"></a>00308         <span class="keywordflow">if</span> ( sub_div_nb &gt; 0 )
<a name="l00309"></a>00309         {
<a name="l00310"></a>00310             <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312             sub_shd = <a class="code" href="bet__data_8c.html#a02747f493a512f416e05204ef14f6925">struct_initialise_hist_div</a> ( );
<a name="l00313"></a>00313             <span class="keywordflow">if</span> ( !sub_shd )
<a name="l00314"></a>00314             {
<a name="l00315"></a>00315                 <a class="code" href="dialog_8c.html#abb50e706a2eedd167eeb63d2de9c1245">dialogue_error_memory</a> ( );
<a name="l00316"></a>00316                 <span class="keywordflow">return</span> FALSE;
<a name="l00317"></a>00317             }
<a name="l00318"></a>00318             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div_nb );
<a name="l00319"></a>00319             sub_shd -&gt; div_number = sub_div_nb;
<a name="l00320"></a>00320             g_hash_table_insert ( shd -&gt; sub_div_list, sub_key, sub_shd );
<a name="l00321"></a>00321         }
<a name="l00322"></a>00322         g_hash_table_insert ( bet_hist_div_list, key, shd );
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324 
<a name="l00325"></a>00325     <span class="keywordflow">return</span> TRUE;
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 
<a name="l00335"></a><a class="code" href="bet__data_8h.html#ad0f230cc72b4bb9181f91d2ede65709b">00335</a> <span class="keywordtype">void</span> <a class="code" href="bet__data_8c.html#ad0f230cc72b4bb9181f91d2ede65709b">bet_data_insert_div_hist</a> ( <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd, <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd )
<a name="l00336"></a>00336 {
<a name="l00337"></a>00337     gchar *key;
<a name="l00338"></a>00338     gchar *sub_key;
<a name="l00339"></a>00339     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *tmp_shd;
<a name="l00340"></a>00340 
<a name="l00341"></a>00341     <span class="keywordflow">if</span> ( shd -&gt; account_nb == 0 )
<a name="l00342"></a>00342         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( shd -&gt; div_number ), NULL );
<a name="l00343"></a>00343     <span class="keywordflow">else</span>
<a name="l00344"></a>00344         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( shd -&gt; account_nb ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l00345"></a>00345                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( shd -&gt; div_number ), NULL );
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     <span class="keywordflow">if</span> ( ( tmp_shd = g_hash_table_lookup ( bet_hist_div_list, key ) ) )
<a name="l00348"></a>00348     {
<a name="l00349"></a>00349         tmp_shd -&gt; div_edited = shd -&gt; div_edited;
<a name="l00350"></a>00350         tmp_shd -&gt; amount = shd -&gt; amount;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352         <span class="keywordflow">if</span> ( sub_shd )
<a name="l00353"></a>00353         {
<a name="l00354"></a>00354             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_shd -&gt; div_number );
<a name="l00355"></a>00355             g_hash_table_insert ( tmp_shd -&gt; sub_div_list, sub_key, sub_shd );
<a name="l00356"></a>00356         }
<a name="l00357"></a>00357     }
<a name="l00358"></a>00358     <span class="keywordflow">else</span>
<a name="l00359"></a>00359     {
<a name="l00360"></a>00360         <span class="keywordflow">if</span> ( sub_shd )
<a name="l00361"></a>00361         {
<a name="l00362"></a>00362             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_shd -&gt; div_number );
<a name="l00363"></a>00363             g_hash_table_insert ( shd -&gt; sub_div_list, sub_key, sub_shd );
<a name="l00364"></a>00364         }
<a name="l00365"></a>00365         g_hash_table_insert ( bet_hist_div_list, key, shd );
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367 }
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 
<a name="l00376"></a><a class="code" href="bet__data_8h.html#a2ad8c256ef5056925b921a71d8645578">00376</a> gboolean <a class="code" href="bet__data_8c.html#a2ad8c256ef5056925b921a71d8645578">bet_data_remove_div_hist</a> ( gint account_nb, gint div_number, gint sub_div_nb )
<a name="l00377"></a>00377 {
<a name="l00378"></a>00378     gchar *key;
<a name="l00379"></a>00379     <span class="keywordtype">char</span> *sub_key;
<a name="l00380"></a>00380     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd;
<a name="l00381"></a>00381     
<a name="l00382"></a>00382     <span class="keywordflow">if</span> ( account_nb == 0 )
<a name="l00383"></a>00383         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00384"></a>00384     <span class="keywordflow">else</span>
<a name="l00385"></a>00385         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( account_nb ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l00386"></a>00386                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00387"></a>00387 
<a name="l00388"></a>00388     <span class="keywordflow">if</span> ( ( shd = g_hash_table_lookup ( bet_hist_div_list, key ) ) )
<a name="l00389"></a>00389     {
<a name="l00390"></a>00390         <span class="keywordflow">if</span> ( sub_div_nb &gt; 0 )
<a name="l00391"></a>00391         {
<a name="l00392"></a>00392             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div_nb );
<a name="l00393"></a>00393             g_hash_table_remove ( shd -&gt; sub_div_list, sub_key );
<a name="l00394"></a>00394         }
<a name="l00395"></a>00395         <span class="keywordflow">if</span> ( g_hash_table_size ( shd -&gt; sub_div_list ) == 0 )
<a name="l00396"></a>00396             g_hash_table_remove ( bet_hist_div_list, key );
<a name="l00397"></a>00397     }
<a name="l00398"></a>00398     <span class="keywordflow">else</span>
<a name="l00399"></a>00399         <span class="keywordflow">return</span> FALSE;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <span class="keywordflow">return</span> TRUE;
<a name="l00402"></a>00402 }
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 
<a name="l00411"></a><a class="code" href="bet__data_8h.html#aa5a0bad0ab672a04b4dfa18d9816aa20">00411</a> gboolean <a class="code" href="bet__data_8c.html#aa5a0bad0ab672a04b4dfa18d9816aa20">bet_data_search_div_hist</a> ( gint account_nb, gint div_number, gint sub_div_nb )
<a name="l00412"></a>00412 {
<a name="l00413"></a>00413     gchar *key;
<a name="l00414"></a>00414     gchar *sub_key;
<a name="l00415"></a>00415     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417     <span class="keywordflow">if</span> ( account_nb == 0 )
<a name="l00418"></a>00418         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00419"></a>00419     <span class="keywordflow">else</span>
<a name="l00420"></a>00420         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( account_nb ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l00421"></a>00421                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00422"></a>00422 
<a name="l00423"></a>00423     <span class="keywordflow">if</span> ( ( shd = g_hash_table_lookup ( bet_hist_div_list, key ) ) )
<a name="l00424"></a>00424     {
<a name="l00425"></a>00425         <span class="keywordflow">if</span> ( sub_div_nb == 0 )
<a name="l00426"></a>00426         {
<a name="l00427"></a>00427             g_free ( key );
<a name="l00428"></a>00428             <span class="keywordflow">return</span> TRUE;
<a name="l00429"></a>00429         }
<a name="l00430"></a>00430         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sub_div_nb &gt; 0 );
<a name="l00431"></a>00431         {
<a name="l00432"></a>00432             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div_nb );
<a name="l00433"></a>00433             <span class="keywordflow">if</span> (  g_hash_table_lookup ( shd -&gt; sub_div_list, sub_key ) )
<a name="l00434"></a>00434             {
<a name="l00435"></a>00435                 g_free ( key );
<a name="l00436"></a>00436                 g_free ( sub_key );
<a name="l00437"></a>00437                 <span class="keywordflow">return</span> TRUE;
<a name="l00438"></a>00438             }
<a name="l00439"></a>00439             g_free ( sub_key );
<a name="l00440"></a>00440         }
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     g_free ( key );
<a name="l00444"></a>00444     <span class="keywordflow">return</span> FALSE;
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 
<a name="l00454"></a><a class="code" href="bet__data_8h.html#aa8173c7d047bf72aef314ecf99689f73">00454</a> gboolean <a class="code" href="bet__data_8c.html#aa8173c7d047bf72aef314ecf99689f73">bet_data_set_div_ptr</a> ( gint type_div )
<a name="l00455"></a>00455 {
<a name="l00456"></a>00456     <span class="keywordflow">if</span> ( type_div == 0 )
<a name="l00457"></a>00457     {
<a name="l00458"></a>00458         <a class="code" href="bet__data_8c.html#a30c03a279ce8440557b96c66cee7dfeb">ptr_div</a> = &amp;<a class="code" href="gsb__data__mix_8c.html#ac80ddad52ce85a6a444b717f4fa0dcd4">gsb_data_mix_get_category_number</a>;
<a name="l00459"></a>00459         <a class="code" href="bet__data_8c.html#aef277c7a40bd87dddd1debe83ce337bf">ptr_sub_div</a> = &amp;<a class="code" href="gsb__data__mix_8c.html#a9457ca7226d64e11bbbf1120c9d5a660">gsb_data_mix_get_sub_category_number</a>;
<a name="l00460"></a>00460         <a class="code" href="bet__data_8c.html#a932f6d02883ab21b24a201e03911aaf2">ptr_type</a> = &amp;<a class="code" href="gsb__data__category_8c.html#ad207c5dac58f010fe8c73c4e2f2f5a58">gsb_data_category_get_type</a>;
<a name="l00461"></a>00461         <a class="code" href="bet__data_8c.html#a077bff3a3e81222d14f90c23c886e99c">ptr_div_name</a> = &amp;<a class="code" href="gsb__data__category_8c.html#a615342249ac310a61000690303ce88a9">gsb_data_category_get_name</a>;
<a name="l00462"></a>00462     }
<a name="l00463"></a>00463     <span class="keywordflow">else</span>
<a name="l00464"></a>00464     {
<a name="l00465"></a>00465         <a class="code" href="bet__data_8c.html#a30c03a279ce8440557b96c66cee7dfeb">ptr_div</a> = &amp;<a class="code" href="gsb__data__mix_8c.html#a45830c30d41b2587fa29718ed7e4dd00">gsb_data_mix_get_budgetary_number</a>;
<a name="l00466"></a>00466         <a class="code" href="bet__data_8c.html#aef277c7a40bd87dddd1debe83ce337bf">ptr_sub_div</a> = &amp;<a class="code" href="gsb__data__mix_8c.html#a506db91a5bcc2237ef00303b469d1d9e">gsb_data_mix_get_sub_budgetary_number</a>;
<a name="l00467"></a>00467         <a class="code" href="bet__data_8c.html#a932f6d02883ab21b24a201e03911aaf2">ptr_type</a> = &amp;<a class="code" href="gsb__data__budget_8c.html#a11b94ff79cd2f1c623fd8e83463a2321">gsb_data_budget_get_type</a>;
<a name="l00468"></a>00468         <a class="code" href="bet__data_8c.html#a077bff3a3e81222d14f90c23c886e99c">ptr_div_name</a> = &amp;<a class="code" href="gsb__data__budget_8c.html#af857141b1d34674997a047500fd76060">gsb_data_budget_get_name</a>;
<a name="l00469"></a>00469     }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471     <span class="keywordflow">return</span> FALSE;
<a name="l00472"></a>00472 }
<a name="l00479"></a><a class="code" href="bet__data_8h.html#ab4bf76da9537ef326910893cb8efca75">00479</a> gint <a class="code" href="bet__data_8c.html#ab4bf76da9537ef326910893cb8efca75">bet_data_get_div_number</a> ( gint transaction_number, gboolean is_transaction )
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481     <span class="keywordflow">return</span> <a class="code" href="bet__data_8c.html#a30c03a279ce8440557b96c66cee7dfeb">ptr_div</a> ( transaction_number, is_transaction );
<a name="l00482"></a>00482 }
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 
<a name="l00491"></a><a class="code" href="bet__data_8h.html#a92ceecac038add334e75ef1c12f7a666">00491</a> gint <a class="code" href="bet__data_8c.html#a92ceecac038add334e75ef1c12f7a666">bet_data_get_sub_div_nb</a> ( gint transaction_number, gboolean is_transaction )
<a name="l00492"></a>00492 {
<a name="l00493"></a>00493     <span class="keywordflow">return</span> <a class="code" href="bet__data_8c.html#aef277c7a40bd87dddd1debe83ce337bf">ptr_sub_div</a> ( transaction_number, is_transaction );
<a name="l00494"></a>00494 }
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 
<a name="l00503"></a><a class="code" href="bet__data_8h.html#ae1629f0fcd2e8027d1b9a07d99efbf1d">00503</a> gint <a class="code" href="bet__data_8c.html#ae1629f0fcd2e8027d1b9a07d99efbf1d">bet_data_get_div_type</a> ( gint div_number )
<a name="l00504"></a>00504 {
<a name="l00505"></a>00505     <span class="keywordflow">return</span> <a class="code" href="bet__data_8c.html#a932f6d02883ab21b24a201e03911aaf2">ptr_type</a> ( div_number );
<a name="l00506"></a>00506 }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 
<a name="l00515"></a><a class="code" href="bet__data_8h.html#aea9c573187265658d763308e06b90b05">00515</a> gchar *<a class="code" href="bet__data_8c.html#aea9c573187265658d763308e06b90b05">bet_data_get_div_name</a> ( gint div_num,
<a name="l00516"></a>00516                         gint sub_div,
<a name="l00517"></a>00517                         <span class="keyword">const</span> gchar *return_value_error )
<a name="l00518"></a>00518 {
<a name="l00519"></a>00519     <span class="keywordflow">return</span> g_strdup ( <a class="code" href="bet__data_8c.html#a077bff3a3e81222d14f90c23c886e99c">ptr_div_name</a> ( div_num, sub_div, NULL ) );
<a name="l00520"></a>00520 }
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 
<a name="l00529"></a><a class="code" href="bet__data_8h.html#a404cd035dc7d1d50729066aa299fe43b">00529</a> gboolean <a class="code" href="bet__data_8c.html#a404cd035dc7d1d50729066aa299fe43b">bet_data_get_div_edited</a> ( gint account_nb, gint div_number, gint sub_div_nb )
<a name="l00530"></a>00530 {
<a name="l00531"></a>00531     gchar *key;
<a name="l00532"></a>00532     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd;
<a name="l00533"></a>00533     gboolean edited;
<a name="l00534"></a>00534 
<a name="l00535"></a>00535     <span class="keywordflow">if</span> ( account_nb == 0 )
<a name="l00536"></a>00536         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00537"></a>00537     <span class="keywordflow">else</span>
<a name="l00538"></a>00538         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( account_nb ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l00539"></a>00539                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     <span class="keywordflow">if</span> ( ( shd = g_hash_table_lookup ( bet_hist_div_list, key ) ) )
<a name="l00542"></a>00542     {
<a name="l00543"></a>00543         <span class="keywordflow">if</span> ( sub_div_nb == 0 )
<a name="l00544"></a>00544             edited = shd -&gt; div_edited;
<a name="l00545"></a>00545         <span class="keywordflow">else</span>
<a name="l00546"></a>00546         {
<a name="l00547"></a>00547             gchar *sub_key;
<a name="l00548"></a>00548             <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd;
<a name="l00549"></a>00549 
<a name="l00550"></a>00550             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div_nb );
<a name="l00551"></a>00551             <span class="keywordflow">if</span> ( ( sub_shd = g_hash_table_lookup ( shd -&gt; sub_div_list, sub_key ) ) )
<a name="l00552"></a>00552                 edited = sub_shd -&gt; div_edited;
<a name="l00553"></a>00553             <span class="keywordflow">else</span>
<a name="l00554"></a>00554                 edited = FALSE;
<a name="l00555"></a>00555             g_free ( sub_key );
<a name="l00556"></a>00556         }
<a name="l00557"></a>00557     }
<a name="l00558"></a>00558     <span class="keywordflow">else</span>
<a name="l00559"></a>00559         edited = FALSE;
<a name="l00560"></a>00560     g_free ( key );
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <span class="keywordflow">return</span> edited;
<a name="l00563"></a>00563 }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 
<a name="l00572"></a><a class="code" href="bet__data_8h.html#ac97294377ef5262c8c3940ecdb8e2443">00572</a> gboolean <a class="code" href="bet__data_8c.html#ac97294377ef5262c8c3940ecdb8e2443">bet_data_set_div_edited</a> ( gint account_nb,
<a name="l00573"></a>00573                         gint div_number,
<a name="l00574"></a>00574                         gint sub_div_nb,
<a name="l00575"></a>00575                         gboolean edited )
<a name="l00576"></a>00576 {
<a name="l00577"></a>00577     gchar *key;
<a name="l00578"></a>00578     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580     <span class="keywordflow">if</span> ( account_nb == 0 )
<a name="l00581"></a>00581         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00582"></a>00582     <span class="keywordflow">else</span>
<a name="l00583"></a>00583         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( account_nb ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l00584"></a>00584                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00585"></a>00585 
<a name="l00586"></a>00586     <span class="keywordflow">if</span> ( ( shd = g_hash_table_lookup ( bet_hist_div_list, key ) ) )
<a name="l00587"></a>00587     {
<a name="l00588"></a>00588         <span class="keywordflow">if</span> ( sub_div_nb == 0 )
<a name="l00589"></a>00589             shd -&gt; div_edited = edited;
<a name="l00590"></a>00590         <span class="keywordflow">else</span>
<a name="l00591"></a>00591         {
<a name="l00592"></a>00592             gchar *sub_key;
<a name="l00593"></a>00593             <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd;
<a name="l00594"></a>00594 
<a name="l00595"></a>00595             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div_nb );
<a name="l00596"></a>00596             <span class="keywordflow">if</span> ( ( sub_shd = g_hash_table_lookup ( shd -&gt; sub_div_list, sub_key ) ) )
<a name="l00597"></a>00597                 sub_shd -&gt; div_edited = edited;
<a name="l00598"></a>00598             g_free ( sub_key );
<a name="l00599"></a>00599         }
<a name="l00600"></a>00600     }
<a name="l00601"></a>00601 
<a name="l00602"></a>00602     g_free ( key );
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     <span class="keywordflow">return</span> FALSE;
<a name="l00605"></a>00605 }
<a name="l00606"></a>00606 
<a name="l00607"></a>00607 
<a name="l00614"></a><a class="code" href="bet__data_8h.html#aa0afee08549af46994f0cd802d462338">00614</a> <a class="code" href="structgsb__real.html">gsb_real</a> <a class="code" href="bet__data_8c.html#aa0afee08549af46994f0cd802d462338">bet_data_hist_get_div_amount</a> ( gint account_nb, gint div_number, gint sub_div_nb )
<a name="l00615"></a>00615 {
<a name="l00616"></a>00616     gchar *key;
<a name="l00617"></a>00617     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd;
<a name="l00618"></a>00618     <a class="code" href="structgsb__real.html">gsb_real</a> amount;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620     <span class="keywordflow">if</span> ( account_nb == 0 )
<a name="l00621"></a>00621         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00622"></a>00622     <span class="keywordflow">else</span>
<a name="l00623"></a>00623         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( account_nb ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l00624"></a>00624                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00625"></a>00625 
<a name="l00626"></a>00626     <span class="keywordflow">if</span> ( ( shd = g_hash_table_lookup ( bet_hist_div_list, key ) ) )
<a name="l00627"></a>00627     {
<a name="l00628"></a>00628         <span class="keywordflow">if</span> ( sub_div_nb == 0 )
<a name="l00629"></a>00629             amount = shd -&gt; amount;
<a name="l00630"></a>00630         <span class="keywordflow">else</span>
<a name="l00631"></a>00631         {
<a name="l00632"></a>00632             gchar *sub_key;
<a name="l00633"></a>00633             <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd;
<a name="l00634"></a>00634 
<a name="l00635"></a>00635             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div_nb );
<a name="l00636"></a>00636             <span class="keywordflow">if</span> ( ( sub_shd = g_hash_table_lookup ( shd -&gt; sub_div_list, sub_key ) ) )
<a name="l00637"></a>00637                 amount = sub_shd -&gt; amount;
<a name="l00638"></a>00638             <span class="keywordflow">else</span>
<a name="l00639"></a>00639                 amount = null_real;
<a name="l00640"></a>00640             g_free ( sub_key );
<a name="l00641"></a>00641         }
<a name="l00642"></a>00642     }
<a name="l00643"></a>00643     <span class="keywordflow">else</span>
<a name="l00644"></a>00644         amount = null_real;
<a name="l00645"></a>00645     g_free ( key );
<a name="l00646"></a>00646 
<a name="l00647"></a>00647     <span class="keywordflow">return</span> amount;
<a name="l00648"></a>00648 }
<a name="l00649"></a>00649 
<a name="l00650"></a>00650 
<a name="l00657"></a><a class="code" href="bet__data_8h.html#a3eeebe94c6f939ab1428c4a3860d7884">00657</a> gboolean <a class="code" href="bet__data_8c.html#a3eeebe94c6f939ab1428c4a3860d7884">bet_data_set_div_amount</a> ( gint account_nb,
<a name="l00658"></a>00658                         gint div_number,
<a name="l00659"></a>00659                         gint sub_div_nb,
<a name="l00660"></a>00660                         <a class="code" href="structgsb__real.html">gsb_real</a> amount )
<a name="l00661"></a>00661 {
<a name="l00662"></a>00662     gchar *key;
<a name="l00663"></a>00663     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665     <span class="keywordflow">if</span> ( account_nb == 0 )
<a name="l00666"></a>00666         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00667"></a>00667     <span class="keywordflow">else</span>
<a name="l00668"></a>00668         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( account_nb ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l00669"></a>00669                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div_number ), NULL );
<a name="l00670"></a>00670 
<a name="l00671"></a>00671     <span class="keywordflow">if</span> ( ( shd = g_hash_table_lookup ( bet_hist_div_list, key ) ) )
<a name="l00672"></a>00672     {
<a name="l00673"></a>00673         <span class="keywordflow">if</span> ( sub_div_nb == 0 )
<a name="l00674"></a>00674             shd -&gt; amount = amount;
<a name="l00675"></a>00675         <span class="keywordflow">else</span>
<a name="l00676"></a>00676         {
<a name="l00677"></a>00677             gchar *sub_key;
<a name="l00678"></a>00678             <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd;
<a name="l00679"></a>00679 
<a name="l00680"></a>00680             sub_key = <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div_nb );
<a name="l00681"></a>00681             <span class="keywordflow">if</span> ( ( sub_shd = g_hash_table_lookup ( shd -&gt; sub_div_list, sub_key ) ) )
<a name="l00682"></a>00682                 sub_shd -&gt; amount = amount;
<a name="l00683"></a>00683             g_free ( sub_key );
<a name="l00684"></a>00684         }
<a name="l00685"></a>00685     }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687     g_free ( key );
<a name="l00688"></a>00688 
<a name="l00689"></a>00689     <span class="keywordflow">return</span> FALSE;
<a name="l00690"></a>00690 }
<a name="l00691"></a>00691 
<a name="l00692"></a>00692 
<a name="l00699"></a><a class="code" href="bet__data_8h.html#a276706a60495ceea4d9b6ce0794888e9">00699</a> gint <a class="code" href="bet__data_8c.html#a276706a60495ceea4d9b6ce0794888e9">bet_data_get_selected_currency</a> ( <span class="keywordtype">void</span> )
<a name="l00700"></a>00700 {
<a name="l00701"></a>00701     gint selected_account;
<a name="l00702"></a>00702     gint currency_number;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704     selected_account = <a class="code" href="navigation_8c.html#a3b668bf52ce71dcff3ea10c9db7be859">gsb_gui_navigation_get_current_account</a> ( );
<a name="l00705"></a>00705     <span class="keywordflow">if</span> ( selected_account == -1 )
<a name="l00706"></a>00706         <span class="keywordflow">return</span> 0;
<a name="l00707"></a>00707 
<a name="l00708"></a>00708     currency_number = <a class="code" href="gsb__data__account_8c.html#a9f8d132b988ca73a7061fca955f6bc2c">gsb_data_account_get_currency</a> ( selected_account );
<a name="l00709"></a>00709 
<a name="l00710"></a>00710     <span class="keywordflow">return</span> currency_number;
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 
<a name="l00713"></a>00713 
<a name="l00720"></a><a class="code" href="bet__data_8h.html#a0de6607543e7a4e0f2051394707631b5">00720</a> gboolean <a class="code" href="bet__data_8c.html#a0de6607543e7a4e0f2051394707631b5">bet_data_populate_div</a> ( gint transaction_number,
<a name="l00721"></a>00721                         gboolean is_transaction,
<a name="l00722"></a>00722                         GHashTable  *list_div )
<a name="l00723"></a>00723 {
<a name="l00724"></a>00724     gint div = 0;
<a name="l00725"></a>00725     gint sub_div = 0;
<a name="l00726"></a>00726     <a class="code" href="struct__historical.html">SH</a> *sh = NULL;
<a name="l00727"></a>00727 
<a name="l00728"></a>00728     div = <a class="code" href="bet__data_8c.html#a30c03a279ce8440557b96c66cee7dfeb">ptr_div</a> ( transaction_number, is_transaction );
<a name="l00729"></a>00729     <span class="keywordflow">if</span> ( div &gt; 0 )
<a name="l00730"></a>00730         sub_div = <a class="code" href="bet__data_8c.html#aef277c7a40bd87dddd1debe83ce337bf">ptr_sub_div</a> ( transaction_number, is_transaction );
<a name="l00731"></a>00731     <span class="keywordflow">else</span>
<a name="l00732"></a>00732         <span class="keywordflow">return</span> FALSE;
<a name="l00733"></a>00733     
<a name="l00734"></a>00734     <span class="keywordflow">if</span> ( (sh = g_hash_table_lookup ( list_div, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div ) ) ) )
<a name="l00735"></a>00735         bet_data_update_div ( sh, transaction_number, sub_div );
<a name="l00736"></a>00736     <span class="keywordflow">else</span>
<a name="l00737"></a>00737     {
<a name="l00738"></a>00738         sh = struct_initialise_bet_historical ( );
<a name="l00739"></a>00739         sh -&gt; div = div;
<a name="l00740"></a>00740         sh -&gt; account_nb = <a class="code" href="gsb__data__transaction_8c.html#a5b486efbc486f946e9c998a114054bce">gsb_data_transaction_get_account_number</a> ( transaction_number );
<a name="l00741"></a>00741         bet_data_update_div ( sh, transaction_number, sub_div );
<a name="l00742"></a>00742         g_hash_table_insert ( list_div, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( div ), sh );
<a name="l00743"></a>00743     }
<a name="l00744"></a>00744 
<a name="l00745"></a>00745     <span class="keywordflow">return</span> FALSE;
<a name="l00746"></a>00746 }
<a name="l00747"></a>00747 
<a name="l00748"></a>00748 
<a name="l00755"></a>00755 gboolean bet_data_update_div ( <a class="code" href="struct__historical.html">SH</a> *sh, gint transaction_number, gint sub_div )
<a name="l00756"></a>00756 {
<a name="l00757"></a>00757     <a class="code" href="struct__bet__range.html">SBR</a> *sbr = ( <a class="code" href="struct__bet__range.html">SBR</a>*) sh -&gt; sbr;
<a name="l00758"></a>00758     <a class="code" href="structgsb__real.html">gsb_real</a> amount;
<a name="l00759"></a>00759     <a class="code" href="struct__historical.html">SH</a> *tmp_sh = NULL;
<a name="l00760"></a>00760 
<a name="l00761"></a>00761     amount = <a class="code" href="gsb__data__transaction_8c.html#a632c5ba71e742b3ac063b4b3207cf032">gsb_data_transaction_get_amount</a> ( transaction_number );
<a name="l00762"></a>00762     sbr-&gt; current_balance = <a class="code" href="gsb__real_8c.html#a5a3e9b2189f43f10c28333b09179e335">gsb_real_add</a> ( sbr -&gt; current_balance, amount );
<a name="l00763"></a>00763 
<a name="l00764"></a>00764     <span class="keywordflow">if</span> ( sub_div &lt; 1 )
<a name="l00765"></a>00765         <span class="keywordflow">return</span> FALSE;
<a name="l00766"></a>00766 
<a name="l00767"></a>00767     <span class="keywordflow">if</span> ( ( tmp_sh = g_hash_table_lookup ( sh -&gt; list_sub_div, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div ) ) ) )
<a name="l00768"></a>00768         bet_data_update_div ( tmp_sh, transaction_number, -1 );
<a name="l00769"></a>00769     <span class="keywordflow">else</span>
<a name="l00770"></a>00770     {
<a name="l00771"></a>00771         tmp_sh = struct_initialise_bet_historical ( );
<a name="l00772"></a>00772         tmp_sh -&gt; div = sub_div;
<a name="l00773"></a>00773         tmp_sh -&gt; account_nb = <a class="code" href="gsb__data__transaction_8c.html#a5b486efbc486f946e9c998a114054bce">gsb_data_transaction_get_account_number</a> ( transaction_number );
<a name="l00774"></a>00774         bet_data_update_div ( tmp_sh, transaction_number, -1 );
<a name="l00775"></a>00775         g_hash_table_insert ( sh -&gt; list_sub_div, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( sub_div ), tmp_sh );
<a name="l00776"></a>00776     }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778     <span class="keywordflow">return</span> FALSE;
<a name="l00779"></a>00779 }
<a name="l00780"></a>00780 
<a name="l00781"></a>00781 
<a name="l00788"></a><a class="code" href="bet__data_8h.html#a4185b5667139f402a298806bb53a211a">00788</a> GPtrArray *<a class="code" href="bet__data_8c.html#a4185b5667139f402a298806bb53a211a">bet_data_get_strings_to_save</a> ( <span class="keywordtype">void</span> )
<a name="l00789"></a>00789 {
<a name="l00790"></a>00790     GPtrArray *tab = NULL;
<a name="l00791"></a>00791     gchar *tmp_str = NULL;
<a name="l00792"></a>00792     GHashTableIter iter;
<a name="l00793"></a>00793     gpointer key, value;
<a name="l00794"></a>00794     gint index = 0;
<a name="l00795"></a>00795 
<a name="l00796"></a>00796     <span class="keywordflow">if</span> ( g_hash_table_size ( bet_hist_div_list ) == 0
<a name="l00797"></a>00797      &amp;&amp;
<a name="l00798"></a>00798         g_hash_table_size ( bet_future_list ) == 0
<a name="l00799"></a>00799      &amp;&amp;
<a name="l00800"></a>00800         g_hash_table_size ( bet_transfert_list ) == 0 )
<a name="l00801"></a>00801         <span class="keywordflow">return</span> NULL;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803     tab = g_ptr_array_new ( );
<a name="l00804"></a>00804 
<a name="l00805"></a>00805     g_hash_table_iter_init ( &amp;iter, bet_hist_div_list );
<a name="l00806"></a>00806     <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) )
<a name="l00807"></a>00807     {
<a name="l00808"></a>00808         <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd = ( <a class="code" href="struct__hist__div.html">struct_hist_div</a>* ) value;
<a name="l00809"></a>00809 
<a name="l00810"></a>00810         <span class="keywordflow">if</span> ( g_hash_table_size ( shd -&gt; sub_div_list ) == 0 )
<a name="l00811"></a>00811         {
<a name="l00812"></a>00812             tmp_str = g_markup_printf_escaped ( <span class="stringliteral">&quot;\t&lt;Bet_historical Nb=\&quot;%d\&quot; Ac=\&quot;%d\&quot; &quot;</span>
<a name="l00813"></a>00813                         <span class="stringliteral">&quot;Div=\&quot;%d\&quot; Edit=\&quot;%d\&quot; Damount=\&quot;%s\&quot; SDiv=\&quot;%d\&quot; &quot;</span>
<a name="l00814"></a>00814                         <span class="stringliteral">&quot;SEdit=\&quot;%d\&quot; SDamount=\&quot;%s\&quot; /&gt;\n&quot;</span>,
<a name="l00815"></a>00815                         tab -&gt; len + 1,
<a name="l00816"></a>00816                         shd -&gt; account_nb,
<a name="l00817"></a>00817                         shd -&gt; div_number,
<a name="l00818"></a>00818                         shd -&gt; div_edited,
<a name="l00819"></a>00819                         <a class="code" href="gsb__real_8c.html#a50c880e082aa7241dfa50a9bc0a87207">gsb_real_save_real_to_string</a> ( shd -&gt; amount, 2 ),
<a name="l00820"></a>00820                         0, 0, <span class="stringliteral">&quot;0.00&quot;</span> );
<a name="l00821"></a>00821 
<a name="l00822"></a>00822             g_ptr_array_add ( tab, tmp_str );
<a name="l00823"></a>00823         }
<a name="l00824"></a>00824         <span class="keywordflow">else</span>
<a name="l00825"></a>00825         {
<a name="l00826"></a>00826             GHashTableIter new_iter;
<a name="l00827"></a>00827 
<a name="l00828"></a>00828             g_hash_table_iter_init ( &amp;new_iter, shd -&gt; sub_div_list );
<a name="l00829"></a>00829             <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;new_iter, &amp;key, &amp;value ) )
<a name="l00830"></a>00830             {
<a name="l00831"></a>00831                 <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd = ( <a class="code" href="struct__hist__div.html">struct_hist_div</a>* ) value;
<a name="l00832"></a>00832 
<a name="l00833"></a>00833                 tmp_str = g_markup_printf_escaped ( <span class="stringliteral">&quot;\t&lt;Bet_historical Nb=\&quot;%d\&quot; Ac=\&quot;%d\&quot; &quot;</span>
<a name="l00834"></a>00834                         <span class="stringliteral">&quot;Div=\&quot;%d\&quot; Edit=\&quot;%d\&quot; Damount=\&quot;%s\&quot; SDiv=\&quot;%d\&quot; &quot;</span>
<a name="l00835"></a>00835                         <span class="stringliteral">&quot;SEdit=\&quot;%d\&quot; SDamount=\&quot;%s\&quot; /&gt;\n&quot;</span>,
<a name="l00836"></a>00836                         tab -&gt; len + 1,
<a name="l00837"></a>00837                         shd -&gt; account_nb,
<a name="l00838"></a>00838                         shd -&gt; div_number,
<a name="l00839"></a>00839                         shd -&gt; div_edited,
<a name="l00840"></a>00840                         <a class="code" href="gsb__real_8c.html#a50c880e082aa7241dfa50a9bc0a87207">gsb_real_save_real_to_string</a> ( shd -&gt; amount, 2 ),
<a name="l00841"></a>00841                         sub_shd -&gt; div_number,
<a name="l00842"></a>00842                         sub_shd -&gt; div_edited,
<a name="l00843"></a>00843                         <a class="code" href="gsb__real_8c.html#a50c880e082aa7241dfa50a9bc0a87207">gsb_real_save_real_to_string</a> ( sub_shd -&gt; amount, 2 ) );
<a name="l00844"></a>00844 
<a name="l00845"></a>00845                 g_ptr_array_add ( tab, tmp_str );
<a name="l00846"></a>00846             }
<a name="l00847"></a>00847         }
<a name="l00848"></a>00848     }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850     g_hash_table_iter_init ( &amp;iter, bet_future_list );
<a name="l00851"></a>00851     <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) )
<a name="l00852"></a>00852     {
<a name="l00853"></a>00853         <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled = ( <a class="code" href="struct__future__data.html">struct_futur_data</a>* ) value;
<a name="l00854"></a>00854         gchar *amount;
<a name="l00855"></a>00855         gchar *date;
<a name="l00856"></a>00856         gchar *limit_date;
<a name="l00857"></a>00857 
<a name="l00858"></a>00858         <span class="comment">/* set the real */</span>
<a name="l00859"></a>00859         amount = <a class="code" href="gsb__real_8c.html#a50c880e082aa7241dfa50a9bc0a87207">gsb_real_save_real_to_string</a> ( scheduled -&gt; amount, 2 );
<a name="l00860"></a>00860 
<a name="l00861"></a>00861         <span class="comment">/* set the dates */</span>
<a name="l00862"></a>00862         date = <a class="code" href="utils__dates_8c.html#abe508780ddee49c70a49b509e731bb27">gsb_format_gdate_safe</a> ( scheduled -&gt; date );
<a name="l00863"></a>00863         limit_date = <a class="code" href="utils__dates_8c.html#abe508780ddee49c70a49b509e731bb27">gsb_format_gdate_safe</a> ( scheduled -&gt; limit_date );
<a name="l00864"></a>00864 
<a name="l00865"></a>00865         tmp_str = g_markup_printf_escaped ( <span class="stringliteral">&quot;\t&lt;Bet_future Nb=\&quot;%d\&quot; Dt=\&quot;%s\&quot; Ac=\&quot;%d\&quot; &quot;</span>
<a name="l00866"></a>00866                         <span class="stringliteral">&quot;Am=\&quot;%s\&quot; Pa=\&quot;%d\&quot; IsT=\&quot;%d\&quot; Tra=\&quot;%d\&quot; Ca=\&quot;%d\&quot; Sca=\&quot;%d\&quot; &quot;</span>
<a name="l00867"></a>00867                         <span class="stringliteral">&quot;Pn=\&quot;%d\&quot; Fi=\&quot;%d\&quot; Bu=\&quot;%d\&quot; Sbu=\&quot;%d\&quot; No=\&quot;%s\&quot; Au=\&quot;0\&quot; &quot;</span>
<a name="l00868"></a>00868                         <span class="stringliteral">&quot;Pe=\&quot;%d\&quot; Pei=\&quot;%d\&quot; Pep=\&quot;%d\&quot; Dtl=\&quot;%s\&quot; Mo=\&quot;%d\&quot; /&gt;\n&quot;</span>,
<a name="l00869"></a>00869                                             scheduled -&gt; number,
<a name="l00870"></a>00870                                             <a class="code" href="gsb__file__save_8c.html#afab094df64a133cffdeb914484e1e52d">my_safe_null_str</a> ( date ),
<a name="l00871"></a>00871                                             scheduled -&gt; account_number,
<a name="l00872"></a>00872                                             <a class="code" href="gsb__file__save_8c.html#afab094df64a133cffdeb914484e1e52d">my_safe_null_str</a> ( amount ),
<a name="l00873"></a>00873                                             scheduled -&gt; party_number,
<a name="l00874"></a>00874                         scheduled -&gt; is_transfert,
<a name="l00875"></a>00875                         scheduled -&gt; account_transfert,
<a name="l00876"></a>00876                                             scheduled -&gt; category_number,
<a name="l00877"></a>00877                                             scheduled -&gt; sub_category_number,
<a name="l00878"></a>00878                                             scheduled -&gt; payment_number,
<a name="l00879"></a>00879                                             scheduled -&gt; fyear_number,
<a name="l00880"></a>00880                                             scheduled -&gt; budgetary_number,
<a name="l00881"></a>00881                                             scheduled -&gt; sub_budgetary_number,
<a name="l00882"></a>00882                                             <a class="code" href="gsb__file__save_8c.html#afab094df64a133cffdeb914484e1e52d">my_safe_null_str</a> ( scheduled -&gt; notes ),
<a name="l00883"></a>00883                                             scheduled -&gt; frequency,
<a name="l00884"></a>00884                                             scheduled -&gt; user_interval,
<a name="l00885"></a>00885                                             scheduled -&gt; user_entry,
<a name="l00886"></a>00886                                             <a class="code" href="gsb__file__save_8c.html#afab094df64a133cffdeb914484e1e52d">my_safe_null_str</a> ( limit_date ),
<a name="l00887"></a>00887                         scheduled -&gt; mother_row );
<a name="l00888"></a>00888 
<a name="l00889"></a>00889         g_ptr_array_add ( tab, tmp_str );
<a name="l00890"></a>00890 
<a name="l00891"></a>00891         g_free (amount);
<a name="l00892"></a>00892         g_free (date);
<a name="l00893"></a>00893         g_free (limit_date);
<a name="l00894"></a>00894     }
<a name="l00895"></a>00895 
<a name="l00896"></a>00896     g_hash_table_iter_init ( &amp;iter, bet_transfert_list );
<a name="l00897"></a>00897     index = 0;
<a name="l00898"></a>00898     <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) )
<a name="l00899"></a>00899     {
<a name="l00900"></a>00900         <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert = ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a>* ) value;
<a name="l00901"></a>00901         gchar *date;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903         <span class="comment">/* set the dates */</span>
<a name="l00904"></a>00904         date = <a class="code" href="utils__dates_8c.html#abe508780ddee49c70a49b509e731bb27">gsb_format_gdate_safe</a> ( transfert -&gt; date );
<a name="l00905"></a>00905 
<a name="l00906"></a>00906         tmp_str = g_markup_printf_escaped ( <span class="stringliteral">&quot;\t&lt;Bet_transfert Nb=\&quot;%d\&quot; Dt=\&quot;%s\&quot; Ac=\&quot;%d\&quot; &quot;</span>
<a name="l00907"></a>00907                         <span class="stringliteral">&quot;Ty=\&quot;%d\&quot; Ra=\&quot;%d\&quot; Rt=\&quot;%d\&quot; Aim=\&quot;%d\&quot; Ca=\&quot;%d\&quot; Sca=\&quot;%d\&quot; &quot;</span>
<a name="l00908"></a>00908                         <span class="stringliteral">&quot;Bu=\&quot;%d\&quot; Sbu=\&quot;%d\&quot; /&gt;\n&quot;</span>,
<a name="l00909"></a>00909                                             ++index,
<a name="l00910"></a>00910                                             <a class="code" href="gsb__file__save_8c.html#afab094df64a133cffdeb914484e1e52d">my_safe_null_str</a> ( date ),
<a name="l00911"></a>00911                                             transfert -&gt; account_number,
<a name="l00912"></a>00912                                             transfert -&gt; type,
<a name="l00913"></a>00913                         transfert -&gt; replace_account,
<a name="l00914"></a>00914                         transfert -&gt; replace_transaction,
<a name="l00915"></a>00915                         transfert -&gt; auto_inc_month,
<a name="l00916"></a>00916                                             transfert -&gt; category_number,
<a name="l00917"></a>00917                                             transfert -&gt; sub_category_number,
<a name="l00918"></a>00918                                             transfert -&gt; budgetary_number,
<a name="l00919"></a>00919                                             transfert -&gt; sub_budgetary_number );
<a name="l00920"></a>00920 
<a name="l00921"></a>00921         g_ptr_array_add ( tab, tmp_str );
<a name="l00922"></a>00922 
<a name="l00923"></a>00923         g_free (date);
<a name="l00924"></a>00924     }
<a name="l00925"></a>00925 
<a name="l00926"></a>00926     <span class="keywordflow">return</span> tab;
<a name="l00927"></a>00927 }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929 
<a name="l00936"></a><a class="code" href="bet__data_8h.html#a91745c4a532e0241a7a257fb8aa53a93">00936</a> <span class="keywordtype">void</span> <a class="code" href="bet__data_8c.html#a91745c4a532e0241a7a257fb8aa53a93">bet_data_synchronise_hist_div_list</a> ( GHashTable  *list_div )
<a name="l00937"></a>00937 {
<a name="l00938"></a>00938     GHashTableIter iter;
<a name="l00939"></a>00939     gpointer key, value;
<a name="l00940"></a>00940     <a class="code" href="struct__historical.html">SH</a> *sh = NULL;
<a name="l00941"></a>00941 
<a name="l00942"></a>00942     g_hash_table_iter_init ( &amp;iter, bet_hist_div_list );
<a name="l00943"></a>00943     <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) ) 
<a name="l00944"></a>00944     {
<a name="l00945"></a>00945         <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd = ( <a class="code" href="struct__hist__div.html">struct_hist_div</a>* ) value;
<a name="l00946"></a>00946         GHashTableIter new_iter;
<a name="l00947"></a>00947 
<a name="l00948"></a>00948         sh = g_hash_table_lookup ( list_div, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( shd -&gt; div_number ) );
<a name="l00949"></a>00949         <span class="keywordflow">if</span> ( sh == NULL )
<a name="l00950"></a>00950             <a class="code" href="bet__data_8c.html#a2ad8c256ef5056925b921a71d8645578">bet_data_remove_div_hist</a> ( shd -&gt; account_nb, shd -&gt; div_number, 0 );
<a name="l00951"></a>00951         <span class="keywordflow">else</span>
<a name="l00952"></a>00952         {
<a name="l00953"></a>00953             g_hash_table_iter_init ( &amp;new_iter, shd -&gt; sub_div_list );
<a name="l00954"></a>00954             <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;new_iter, &amp;key, &amp;value ) )
<a name="l00955"></a>00955             {
<a name="l00956"></a>00956                 <a class="code" href="struct__hist__div.html">struct_hist_div</a> *sub_shd = ( <a class="code" href="struct__hist__div.html">struct_hist_div</a>* ) value;
<a name="l00957"></a>00957 
<a name="l00958"></a>00958                 <span class="keywordflow">if</span> ( !g_hash_table_lookup ( sh -&gt; list_sub_div, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> (
<a name="l00959"></a>00959                  sub_shd -&gt; div_number ) ) )
<a name="l00960"></a>00960                 {
<a name="l00961"></a>00961                     <a class="code" href="bet__data_8c.html#a2ad8c256ef5056925b921a71d8645578">bet_data_remove_div_hist</a> ( shd -&gt; account_nb,
<a name="l00962"></a>00962                                 shd -&gt; div_number,
<a name="l00963"></a>00963                                 sub_shd -&gt; div_number );
<a name="l00964"></a>00964                     g_hash_table_iter_init ( &amp;new_iter, shd -&gt; sub_div_list );
<a name="l00965"></a>00965                 }
<a name="l00966"></a>00966             }
<a name="l00967"></a>00967         }
<a name="l00968"></a>00968     }
<a name="l00969"></a>00969 }
<a name="l00976"></a><a class="code" href="bet__data_8h.html#aadf624d8e035217dfd51c842ea776e3d">00976</a> <a class="code" href="struct__bet__range.html">SBR</a> *<a class="code" href="bet__data_8c.html#aadf624d8e035217dfd51c842ea776e3d">struct_initialise_bet_range</a> ( <span class="keywordtype">void</span> )
<a name="l00977"></a>00977 {
<a name="l00978"></a>00978         <a class="code" href="struct__bet__range.html">SBR</a>     *sbr;
<a name="l00979"></a>00979         
<a name="l00980"></a>00980         sbr = g_malloc0 ( <span class="keyword">sizeof</span> ( <a class="code" href="struct__bet__range.html">SBR</a> ) );
<a name="l00981"></a>00981     sbr -&gt; first_pass = TRUE;
<a name="l00982"></a>00982     sbr -&gt; min_date = NULL;
<a name="l00983"></a>00983     sbr -&gt; max_date = NULL;
<a name="l00984"></a>00984     sbr -&gt; min_balance = null_real;
<a name="l00985"></a>00985     sbr -&gt; max_balance = null_real;
<a name="l00986"></a>00986     sbr -&gt; current_balance = null_real;
<a name="l00987"></a>00987 
<a name="l00988"></a>00988         <span class="keywordflow">return</span> sbr;
<a name="l00989"></a>00989 }
<a name="l00990"></a>00990 
<a name="l00991"></a>00991 
<a name="l00998"></a>00998 <span class="keywordtype">void</span> struct_free_bet_range ( <a class="code" href="struct__bet__range.html">SBR</a> *sbr )
<a name="l00999"></a>00999 {
<a name="l01000"></a>01000     <span class="keywordflow">if</span> ( sbr-&gt; min_date )
<a name="l01001"></a>01001         g_date_free ( sbr-&gt; min_date );
<a name="l01002"></a>01002     <span class="keywordflow">if</span> ( sbr-&gt; max_date )
<a name="l01003"></a>01003         g_date_free ( sbr-&gt; max_date );
<a name="l01004"></a>01004 
<a name="l01005"></a>01005     g_free ( sbr );
<a name="l01006"></a>01006 }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 
<a name="l01015"></a>01015 <a class="code" href="struct__historical.html">SH</a> *struct_initialise_bet_historical ( <span class="keywordtype">void</span> )
<a name="l01016"></a>01016 {
<a name="l01017"></a>01017         <a class="code" href="struct__historical.html">SH</a>      *sh;
<a name="l01018"></a>01018 
<a name="l01019"></a>01019         sh = g_malloc0 ( <span class="keyword">sizeof</span> ( <a class="code" href="struct__historical.html">SH</a> ) );
<a name="l01020"></a>01020     sh -&gt; sbr = <a class="code" href="bet__data_8c.html#aadf624d8e035217dfd51c842ea776e3d">struct_initialise_bet_range</a> ( );
<a name="l01021"></a>01021     sh -&gt; list_sub_div = g_hash_table_new_full ( g_str_hash,
<a name="l01022"></a>01022                         g_str_equal,
<a name="l01023"></a>01023                         NULL,
<a name="l01024"></a>01024                         (GDestroyNotify) <a class="code" href="bet__data_8c.html#a89a8671d4171468fbbd9cb1f36689f71">struct_free_bet_historical</a> );
<a name="l01025"></a>01025         <span class="keywordflow">return</span> sh;
<a name="l01026"></a>01026 }
<a name="l01027"></a>01027 
<a name="l01028"></a>01028 
<a name="l01035"></a><a class="code" href="bet__data_8h.html#a89a8671d4171468fbbd9cb1f36689f71">01035</a> <span class="keywordtype">void</span> <a class="code" href="bet__data_8c.html#a89a8671d4171468fbbd9cb1f36689f71">struct_free_bet_historical</a> ( <a class="code" href="struct__historical.html">SH</a> *sh )
<a name="l01036"></a>01036 {
<a name="l01037"></a>01037 
<a name="l01038"></a>01038     <span class="keywordflow">if</span> ( sh -&gt; sbr )
<a name="l01039"></a>01039         struct_free_bet_range ( sh -&gt; sbr );
<a name="l01040"></a>01040     <span class="keywordflow">if</span> ( sh -&gt; list_sub_div )
<a name="l01041"></a>01041         g_hash_table_remove_all ( sh -&gt; list_sub_div );
<a name="l01042"></a>01042 
<a name="l01043"></a>01043     g_free ( sh );
<a name="l01044"></a>01044 }
<a name="l01045"></a>01045 
<a name="l01046"></a>01046 
<a name="l01053"></a><a class="code" href="bet__data_8h.html#a02747f493a512f416e05204ef14f6925">01053</a> <a class="code" href="struct__hist__div.html">struct_hist_div</a> *<a class="code" href="bet__data_8c.html#a02747f493a512f416e05204ef14f6925">struct_initialise_hist_div</a> ( <span class="keywordtype">void</span> )
<a name="l01054"></a>01054 {
<a name="l01055"></a>01055     <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd;
<a name="l01056"></a>01056 
<a name="l01057"></a>01057     shd = g_malloc0 ( <span class="keyword">sizeof</span> ( <a class="code" href="struct__hist__div.html">struct_hist_div</a> ) );
<a name="l01058"></a>01058     shd -&gt; account_nb = 0;
<a name="l01059"></a>01059     shd -&gt; div_number = 0;
<a name="l01060"></a>01060     shd -&gt; div_edited = FALSE;
<a name="l01061"></a>01061     shd -&gt; amount = null_real;
<a name="l01062"></a>01062     shd -&gt; sub_div_list = g_hash_table_new_full ( g_str_hash,
<a name="l01063"></a>01063                         g_str_equal,
<a name="l01064"></a>01064                         (GDestroyNotify) g_free,
<a name="l01065"></a>01065                         (GDestroyNotify) struct_free_hist_div );
<a name="l01066"></a>01066 
<a name="l01067"></a>01067     <span class="keywordflow">return</span> shd;
<a name="l01068"></a>01068 }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 
<a name="l01077"></a>01077 <span class="keywordtype">void</span> struct_free_hist_div ( <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd )
<a name="l01078"></a>01078 {
<a name="l01079"></a>01079     <span class="keywordflow">if</span> ( shd -&gt; sub_div_list )
<a name="l01080"></a>01080         g_hash_table_remove_all ( shd -&gt; sub_div_list );
<a name="l01081"></a>01081 
<a name="l01082"></a>01082     g_free ( shd );
<a name="l01083"></a>01083 }
<a name="l01084"></a>01084 
<a name="l01091"></a><a class="code" href="bet__data_8h.html#a23e8ade4555e56f2de46d41996b2e5c4">01091</a> <a class="code" href="struct__future__data.html">struct_futur_data</a> *<a class="code" href="bet__data_8c.html#a23e8ade4555e56f2de46d41996b2e5c4">struct_initialise_bet_future</a> ( <span class="keywordtype">void</span> )
<a name="l01092"></a>01092 {
<a name="l01093"></a>01093     <a class="code" href="struct__future__data.html">struct_futur_data</a> *sfd;
<a name="l01094"></a>01094 
<a name="l01095"></a>01095     sfd = g_malloc0 ( <span class="keyword">sizeof</span> ( <a class="code" href="struct__future__data.html">struct_futur_data</a> ) );
<a name="l01096"></a>01096 
<a name="l01097"></a>01097     sfd -&gt; date = NULL;
<a name="l01098"></a>01098     sfd -&gt; amount = null_real;
<a name="l01099"></a>01099     sfd -&gt; notes = NULL;
<a name="l01100"></a>01100     sfd -&gt; limit_date = NULL;
<a name="l01101"></a>01101 
<a name="l01102"></a>01102     <span class="keywordflow">return</span> sfd;
<a name="l01103"></a>01103 }
<a name="l01104"></a>01104 
<a name="l01105"></a>01105 
<a name="l01112"></a>01112 <span class="keywordtype">void</span> struct_free_bet_future ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled )
<a name="l01113"></a>01113 {
<a name="l01114"></a>01114     <span class="keywordflow">if</span> ( scheduled -&gt; date )
<a name="l01115"></a>01115         g_date_free ( scheduled -&gt; date );
<a name="l01116"></a>01116     <span class="keywordflow">if</span> ( scheduled -&gt; limit_date )
<a name="l01117"></a>01117         g_date_free ( scheduled -&gt; limit_date );
<a name="l01118"></a>01118     <span class="keywordflow">if</span> ( scheduled -&gt; notes )
<a name="l01119"></a>01119         g_free ( scheduled -&gt; notes );
<a name="l01120"></a>01120 
<a name="l01121"></a>01121     g_free ( scheduled );
<a name="l01122"></a>01122 }
<a name="l01123"></a>01123 
<a name="l01124"></a>01124 
<a name="l01131"></a><a class="code" href="bet__data_8h.html#a066b9bb27fff2cf3ab6220e10298ed38">01131</a> gboolean <a class="code" href="bet__data_8c.html#a066b9bb27fff2cf3ab6220e10298ed38">bet_data_future_add_lines</a> ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled )
<a name="l01132"></a>01132 {
<a name="l01133"></a>01133     gchar *key;
<a name="l01134"></a>01134     
<a name="l01135"></a>01135     future_number ++;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137     <span class="keywordflow">if</span> ( scheduled -&gt; frequency == 0 )
<a name="l01138"></a>01138     {
<a name="l01139"></a>01139         <span class="keywordflow">if</span> ( scheduled -&gt; account_number == 0 )
<a name="l01140"></a>01140             key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( future_number ), NULL );
<a name="l01141"></a>01141         <span class="keywordflow">else</span>
<a name="l01142"></a>01142             key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( scheduled -&gt; account_number ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l01143"></a>01143                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( future_number ), NULL );
<a name="l01144"></a>01144 
<a name="l01145"></a>01145         scheduled -&gt; number = future_number;
<a name="l01146"></a>01146         g_hash_table_insert ( bet_future_list, key, scheduled );
<a name="l01147"></a>01147     }
<a name="l01148"></a>01148     <span class="keywordflow">else</span>
<a name="l01149"></a>01149     {
<a name="l01150"></a>01150         GDate *date;
<a name="l01151"></a>01151         GDate *date_max;
<a name="l01152"></a>01152         gint mother_row;
<a name="l01153"></a>01153         <a class="code" href="struct__future__data.html">struct_futur_data</a> *new_sch = NULL;
<a name="l01154"></a>01154 
<a name="l01155"></a>01155         mother_row = future_number;
<a name="l01156"></a>01156 
<a name="l01157"></a>01157         date_max = <a class="code" href="bet__data_8c.html#a0ad9a8f139c9c1fe907454b3130192c3">bet_data_array_get_date_max</a> ( scheduled -&gt; account_number );
<a name="l01158"></a>01158 
<a name="l01159"></a>01159         <span class="comment">/* we don&#39;t change the initial date */</span>
<a name="l01160"></a>01160         date = <a class="code" href="utils__dates_8c.html#ad688d2e013a4c82fa7e1cb47f64054d4">gsb_date_copy</a> ( scheduled -&gt; date );
<a name="l01161"></a>01161         <span class="keywordflow">while</span> ( date != NULL &amp;&amp; g_date_valid ( date ) )
<a name="l01162"></a>01162         {
<a name="l01163"></a>01163             <span class="keywordflow">if</span> ( scheduled -&gt; account_number == 0 )
<a name="l01164"></a>01164                 key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( future_number ), NULL );
<a name="l01165"></a>01165             <span class="keywordflow">else</span>
<a name="l01166"></a>01166                 key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( scheduled -&gt; account_number ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l01167"></a>01167                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( future_number ), NULL );
<a name="l01168"></a>01168 
<a name="l01169"></a>01169             <span class="keywordflow">if</span> ( mother_row == future_number )
<a name="l01170"></a>01170                 new_sch = scheduled;
<a name="l01171"></a>01171             <span class="keywordflow">else</span>
<a name="l01172"></a>01172                 new_sch -&gt; mother_row = mother_row;
<a name="l01173"></a>01173 
<a name="l01174"></a>01174             new_sch -&gt; number = future_number;
<a name="l01175"></a>01175             g_hash_table_insert ( bet_future_list, key, new_sch );
<a name="l01176"></a>01176 
<a name="l01177"></a>01177             date = bet_data_futur_get_next_date ( new_sch, date, date_max );
<a name="l01178"></a>01178             <span class="keywordflow">if</span> ( date == NULL )
<a name="l01179"></a>01179                 <span class="keywordflow">break</span>;
<a name="l01180"></a>01180             future_number ++;
<a name="l01181"></a>01181             new_sch = bet_data_future_copy_struct ( scheduled );
<a name="l01182"></a>01182             new_sch -&gt; date = date;
<a name="l01183"></a>01183         }
<a name="l01184"></a>01184         g_date_free ( date_max );
<a name="l01185"></a>01185     }
<a name="l01186"></a>01186 
<a name="l01187"></a>01187     <span class="keywordflow">if</span> ( <a class="code" href="parametres_8c.html#ab2a744f5d2124688473d13979420e911">etat</a>.<a class="code" href="structgsb__etat__t.html#a9d0fa9057da603e64a601d69d7bf2b51">modification_fichier</a> == 0 )
<a name="l01188"></a>01188         <a class="code" href="traitement__variables_8c.html#aa4084b9e508b1d1fea1d09c6b6208021">modification_fichier</a> ( TRUE );
<a name="l01189"></a>01189 
<a name="l01190"></a>01190     <span class="keywordflow">return</span> TRUE;
<a name="l01191"></a>01191 }
<a name="l01192"></a>01192 
<a name="l01193"></a>01193 
<a name="l01200"></a><a class="code" href="bet__data_8h.html#af0aa62f96e076cc583fa339a7a2ecc48">01200</a> gboolean <a class="code" href="bet__data_8c.html#af0aa62f96e076cc583fa339a7a2ecc48">bet_data_future_set_lines_from_file</a> ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled )
<a name="l01201"></a>01201 {
<a name="l01202"></a>01202     gchar *key;
<a name="l01203"></a>01203 
<a name="l01204"></a>01204         <span class="keywordflow">if</span> ( scheduled -&gt; account_number == 0 )
<a name="l01205"></a>01205             key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( scheduled -&gt; number ), NULL );
<a name="l01206"></a>01206         <span class="keywordflow">else</span>
<a name="l01207"></a>01207             key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( scheduled -&gt; account_number ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l01208"></a>01208                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( scheduled -&gt; number ), NULL );
<a name="l01209"></a>01209 
<a name="l01210"></a>01210         bet_data_future_set_max_number ( scheduled -&gt; number );
<a name="l01211"></a>01211 
<a name="l01212"></a>01212         g_hash_table_insert ( bet_future_list, key, scheduled );
<a name="l01213"></a>01213 
<a name="l01214"></a>01214     <span class="keywordflow">return</span> TRUE;
<a name="l01215"></a>01215 }
<a name="l01216"></a>01216 
<a name="l01217"></a>01217 
<a name="l01224"></a>01224 <span class="keywordtype">void</span> bet_data_future_set_max_number ( gint number )
<a name="l01225"></a>01225 {
<a name="l01226"></a>01226     <span class="keywordflow">if</span> ( number &gt;  future_number )
<a name="l01227"></a>01227         future_number = number;
<a name="l01228"></a>01228 }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230 
<a name="l01237"></a><a class="code" href="bet__data_8h.html#a684351ebf464e4e504106b29c24ba78b">01237</a> GHashTable *<a class="code" href="bet__data_8c.html#a684351ebf464e4e504106b29c24ba78b">bet_data_future_get_list</a> ( <span class="keywordtype">void</span> )
<a name="l01238"></a>01238 {
<a name="l01239"></a>01239     <span class="keywordflow">return</span> bet_future_list;
<a name="l01240"></a>01240 }
<a name="l01241"></a>01241 
<a name="l01242"></a>01242 
<a name="l01252"></a>01252 GDate *bet_data_futur_get_next_date ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled,
<a name="l01253"></a>01253                         <span class="keyword">const</span> GDate *date,
<a name="l01254"></a>01254                         <span class="keyword">const</span> GDate *date_max )
<a name="l01255"></a>01255 {
<a name="l01256"></a>01256     GDate *return_date;
<a name="l01257"></a>01257 
<a name="l01258"></a>01258     <span class="keywordflow">if</span> ( !scheduled
<a name="l01259"></a>01259          ||
<a name="l01260"></a>01260          !scheduled -&gt; frequency
<a name="l01261"></a>01261          ||
<a name="l01262"></a>01262          !date
<a name="l01263"></a>01263          ||
<a name="l01264"></a>01264          !g_date_valid ( date ) )
<a name="l01265"></a>01265         <span class="keywordflow">return</span> NULL;
<a name="l01266"></a>01266 
<a name="l01267"></a>01267     <span class="comment">/* we don&#39;t change the initial date */</span>
<a name="l01268"></a>01268     return_date = <a class="code" href="utils__dates_8c.html#ad688d2e013a4c82fa7e1cb47f64054d4">gsb_date_copy</a> (date);
<a name="l01269"></a>01269 
<a name="l01270"></a>01270     <span class="keywordflow">switch</span> ( scheduled -&gt; frequency )
<a name="l01271"></a>01271     {
<a name="l01272"></a>01272         <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#a12be35db3678d06856d2d0a9ed88c99fa5bf38eda05b85e26a0f7805deb0bc25f">SCHEDULER_PERIODICITY_ONCE_VIEW</a>:
<a name="l01273"></a>01273             <span class="keywordflow">return</span> NULL;
<a name="l01274"></a>01274             <span class="keywordflow">break</span>;
<a name="l01275"></a>01275 
<a name="l01276"></a>01276         <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#a12be35db3678d06856d2d0a9ed88c99fabcdc8af8cb4dbf70adee82e655880b8d">SCHEDULER_PERIODICITY_WEEK_VIEW</a>:
<a name="l01277"></a>01277             g_date_add_days ( return_date, 7 );
<a name="l01278"></a>01278             <span class="keywordflow">break</span>;
<a name="l01279"></a>01279 
<a name="l01280"></a>01280         <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#a12be35db3678d06856d2d0a9ed88c99fabe11ef4b2d7c753f7b1d54269770145e">SCHEDULER_PERIODICITY_MONTH_VIEW</a>:
<a name="l01281"></a>01281             g_date_add_months ( return_date, 1 );
<a name="l01282"></a>01282             <span class="keywordflow">break</span>;
<a name="l01283"></a>01283 
<a name="l01284"></a>01284         <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#a12be35db3678d06856d2d0a9ed88c99fa2db2f2fd4c65c66599f6fab69380cae5">SCHEDULER_PERIODICITY_TWO_MONTHS_VIEW</a>:
<a name="l01285"></a>01285             g_date_add_months ( return_date, 2 );
<a name="l01286"></a>01286             <span class="keywordflow">break</span>;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288         <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#a12be35db3678d06856d2d0a9ed88c99fa56886f0330e75d47ab8ce48862553d0c">SCHEDULER_PERIODICITY_TRIMESTER_VIEW</a>:
<a name="l01289"></a>01289             g_date_add_months ( return_date, 3 );
<a name="l01290"></a>01290             <span class="keywordflow">break</span>;
<a name="l01291"></a>01291 
<a name="l01292"></a>01292         <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#a12be35db3678d06856d2d0a9ed88c99fa827e62a34c30e5cd8bdf60b15bb96009">SCHEDULER_PERIODICITY_YEAR_VIEW</a>:
<a name="l01293"></a>01293             g_date_add_years ( return_date, 1 );
<a name="l01294"></a>01294             <span class="keywordflow">break</span>;
<a name="l01295"></a>01295 
<a name="l01296"></a>01296         <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#a12be35db3678d06856d2d0a9ed88c99faa61a2684a7f9891e9ab77e2e2c877ded">SCHEDULER_PERIODICITY_CUSTOM_VIEW</a>:
<a name="l01297"></a>01297             <span class="keywordflow">if</span> ( scheduled -&gt; user_entry &lt;= 0 )
<a name="l01298"></a>01298             {
<a name="l01299"></a>01299             g_date_free (return_date);
<a name="l01300"></a>01300             <span class="keywordflow">return</span> NULL;
<a name="l01301"></a>01301             }
<a name="l01302"></a>01302 
<a name="l01303"></a>01303             <span class="keywordflow">switch</span> ( scheduled -&gt; user_interval )
<a name="l01304"></a>01304             {
<a name="l01305"></a>01305                 <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#ab4cc7d54ee2fb3a2d61ea6256b850952a1905f331721562b054eb5abd6b6d5cc9">PERIODICITY_DAYS</a>:
<a name="l01306"></a>01306                     g_date_add_days ( return_date, scheduled -&gt; user_entry);
<a name="l01307"></a>01307                     <span class="keywordflow">break</span>;
<a name="l01308"></a>01308 
<a name="l01309"></a>01309                 <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#ab4cc7d54ee2fb3a2d61ea6256b850952af14294244660bfb8e9efcb3c8b784b5e">PERIODICITY_WEEKS</a>:
<a name="l01310"></a>01310                     g_date_add_days ( return_date, scheduled -&gt; user_entry * 7 );
<a name="l01311"></a>01311                     <span class="keywordflow">break</span>;
<a name="l01312"></a>01312 
<a name="l01313"></a>01313                 <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#ab4cc7d54ee2fb3a2d61ea6256b850952a3d48559cf1477ea530192fae290fff37">PERIODICITY_MONTHS</a>:
<a name="l01314"></a>01314                     g_date_add_months ( return_date, scheduled -&gt; user_entry );
<a name="l01315"></a>01315                     <span class="keywordflow">break</span>;
<a name="l01316"></a>01316 
<a name="l01317"></a>01317                 <span class="keywordflow">case</span> <a class="code" href="gsb__scheduler__list_8h.html#ab4cc7d54ee2fb3a2d61ea6256b850952a01edc95473eab3ab0b29b8e1fd43c68a">PERIODICITY_YEARS</a>:
<a name="l01318"></a>01318                     g_date_add_years ( return_date, scheduled -&gt; user_entry );
<a name="l01319"></a>01319                     <span class="keywordflow">break</span>;
<a name="l01320"></a>01320             }
<a name="l01321"></a>01321             <span class="keywordflow">break</span>;
<a name="l01322"></a>01322     }
<a name="l01323"></a>01323 
<a name="l01324"></a>01324     <span class="keywordflow">if</span> ( scheduled -&gt; limit_date )
<a name="l01325"></a>01325     {
<a name="l01326"></a>01326          
<a name="l01327"></a>01327             <span class="keywordflow">if</span> ( g_date_compare ( return_date, scheduled -&gt; limit_date ) &gt; 0 )
<a name="l01328"></a>01328         {
<a name="l01329"></a>01329             g_date_free (return_date);
<a name="l01330"></a>01330             return_date = NULL;
<a name="l01331"></a>01331         }
<a name="l01332"></a>01332     }
<a name="l01333"></a>01333     <span class="keywordflow">else</span>
<a name="l01334"></a>01334     {
<a name="l01335"></a>01335         <span class="keywordflow">if</span> ( g_date_compare ( return_date, date_max ) &gt; 0 )
<a name="l01336"></a>01336         {
<a name="l01337"></a>01337             g_date_free (return_date);
<a name="l01338"></a>01338             return_date = NULL;
<a name="l01339"></a>01339         }
<a name="l01340"></a>01340     }
<a name="l01341"></a>01341     
<a name="l01342"></a>01342     <span class="keywordflow">return</span> ( return_date );
<a name="l01343"></a>01343 }
<a name="l01344"></a>01344 
<a name="l01345"></a>01345 
<a name="l01352"></a>01352 <a class="code" href="struct__future__data.html">struct_futur_data</a> *bet_data_future_copy_struct ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled )
<a name="l01353"></a>01353 {
<a name="l01354"></a>01354     <a class="code" href="struct__future__data.html">struct_futur_data</a> *new_scheduled;
<a name="l01355"></a>01355 
<a name="l01356"></a>01356     new_scheduled = <a class="code" href="bet__data_8c.html#a23e8ade4555e56f2de46d41996b2e5c4">struct_initialise_bet_future</a> ( );
<a name="l01357"></a>01357 
<a name="l01358"></a>01358     <span class="keywordflow">if</span> ( !new_scheduled )
<a name="l01359"></a>01359     {
<a name="l01360"></a>01360         <a class="code" href="dialog_8c.html#abb50e706a2eedd167eeb63d2de9c1245">dialogue_error_memory</a> ();
<a name="l01361"></a>01361         <span class="keywordflow">return</span> NULL;
<a name="l01362"></a>01362     }
<a name="l01363"></a>01363 
<a name="l01364"></a>01364     new_scheduled -&gt;  number = scheduled -&gt; number;
<a name="l01365"></a>01365     new_scheduled -&gt;  account_number = scheduled -&gt; account_number;
<a name="l01366"></a>01366 
<a name="l01367"></a>01367     <span class="keywordflow">if</span> ( g_date_valid ( scheduled -&gt; date ) )
<a name="l01368"></a>01368         new_scheduled -&gt; date = <a class="code" href="utils__dates_8c.html#ad688d2e013a4c82fa7e1cb47f64054d4">gsb_date_copy</a> ( scheduled -&gt; date );
<a name="l01369"></a>01369     <span class="keywordflow">else</span>
<a name="l01370"></a>01370         new_scheduled -&gt; date = NULL;
<a name="l01371"></a>01371 
<a name="l01372"></a>01372     new_scheduled -&gt; amount = <a class="code" href="gsb__real_8c.html#a2de01ed575642df6733b066db62b7211">gsb_real_new</a> ( scheduled -&gt; amount.<a class="code" href="structgsb__real.html#a00c99ad79aa77fb0af5b5e08f140b3ae">mantissa</a>,
<a name="l01373"></a>01373                         scheduled -&gt; amount.<a class="code" href="structgsb__real.html#a7456f056c5e05f97c3786eee0cffc047">exponent</a> );
<a name="l01374"></a>01374     new_scheduled -&gt; fyear_number = scheduled -&gt; fyear_number;
<a name="l01375"></a>01375     new_scheduled -&gt; payment_number = scheduled -&gt; payment_number;
<a name="l01376"></a>01376 
<a name="l01377"></a>01377     new_scheduled -&gt; party_number = scheduled -&gt; party_number;
<a name="l01378"></a>01378     new_scheduled -&gt; is_transfert = scheduled -&gt; is_transfert;
<a name="l01379"></a>01379     new_scheduled -&gt; account_transfert = scheduled -&gt; account_transfert;
<a name="l01380"></a>01380     new_scheduled -&gt; category_number = scheduled -&gt; category_number;
<a name="l01381"></a>01381     new_scheduled -&gt; sub_category_number = scheduled -&gt; sub_category_number;
<a name="l01382"></a>01382     new_scheduled -&gt; budgetary_number = scheduled -&gt; budgetary_number;
<a name="l01383"></a>01383     new_scheduled -&gt; sub_budgetary_number = scheduled -&gt; sub_budgetary_number;
<a name="l01384"></a>01384     new_scheduled -&gt; notes = g_strdup ( scheduled -&gt; notes );
<a name="l01385"></a>01385 
<a name="l01386"></a>01386     new_scheduled -&gt; frequency = scheduled -&gt; frequency;
<a name="l01387"></a>01387     new_scheduled -&gt; user_interval = scheduled -&gt; user_interval;
<a name="l01388"></a>01388     new_scheduled -&gt; user_entry = scheduled -&gt; user_entry;
<a name="l01389"></a>01389 
<a name="l01390"></a>01390     <span class="keywordflow">if</span> ( scheduled -&gt; limit_date &amp;&amp; g_date_valid ( scheduled -&gt; limit_date ) )
<a name="l01391"></a>01391         new_scheduled -&gt; limit_date = <a class="code" href="utils__dates_8c.html#ad688d2e013a4c82fa7e1cb47f64054d4">gsb_date_copy</a> ( scheduled -&gt; limit_date );
<a name="l01392"></a>01392     <span class="keywordflow">else</span>
<a name="l01393"></a>01393         new_scheduled -&gt; limit_date = NULL;
<a name="l01394"></a>01394 
<a name="l01395"></a>01395     new_scheduled -&gt; mother_row = scheduled -&gt; mother_row;
<a name="l01396"></a>01396 
<a name="l01397"></a>01397     <span class="keywordflow">return</span> new_scheduled;
<a name="l01398"></a>01398 }
<a name="l01405"></a><a class="code" href="bet__data_8h.html#a5feeffaadf0363f8d23e005000bb8518">01405</a> gboolean <a class="code" href="bet__data_8c.html#a5feeffaadf0363f8d23e005000bb8518">bet_data_future_remove_line</a> ( gint account_number, gint number, gboolean maj )
<a name="l01406"></a>01406 {
<a name="l01407"></a>01407     GHashTableIter iter;
<a name="l01408"></a>01408     gpointer key, value;
<a name="l01409"></a>01409 
<a name="l01410"></a>01410     g_hash_table_iter_init ( &amp;iter, bet_future_list );
<a name="l01411"></a>01411     <span class="keywordflow">while</span> (g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) ) 
<a name="l01412"></a>01412     {
<a name="l01413"></a>01413         <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled = ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *) value;
<a name="l01414"></a>01414 
<a name="l01415"></a>01415         <span class="keywordflow">if</span> ( number != scheduled -&gt; number )
<a name="l01416"></a>01416             <span class="keywordflow">continue</span>;
<a name="l01417"></a>01417 
<a name="l01418"></a>01418         <span class="keywordflow">if</span> ( account_number != scheduled -&gt; account_number )
<a name="l01419"></a>01419         {
<a name="l01420"></a>01420             <span class="keywordflow">if</span> ( scheduled -&gt; is_transfert == 0
<a name="l01421"></a>01421              || ( scheduled -&gt; is_transfert &amp;&amp; account_number != scheduled -&gt; account_transfert ) )
<a name="l01422"></a>01422                 <span class="keywordflow">continue</span>;
<a name="l01423"></a>01423         }
<a name="l01424"></a>01424 
<a name="l01425"></a>01425         g_hash_table_iter_remove ( &amp;iter );
<a name="l01426"></a>01426 
<a name="l01427"></a>01427         <span class="keywordflow">break</span>;
<a name="l01428"></a>01428     }
<a name="l01429"></a>01429 
<a name="l01430"></a>01430     <span class="keywordflow">if</span> ( <a class="code" href="parametres_8c.html#ab2a744f5d2124688473d13979420e911">etat</a>.<a class="code" href="structgsb__etat__t.html#a9d0fa9057da603e64a601d69d7bf2b51">modification_fichier</a> == 0 )
<a name="l01431"></a>01431         <a class="code" href="traitement__variables_8c.html#aa4084b9e508b1d1fea1d09c6b6208021">modification_fichier</a> ( TRUE );
<a name="l01432"></a>01432 
<a name="l01433"></a>01433     <span class="keywordflow">if</span> ( maj )
<a name="l01434"></a>01434     {
<a name="l01435"></a>01435         <a class="code" href="gsb__data__account_8c.html#aad11cfab16ac44e8de3dd6d792fce4cd">gsb_data_account_set_bet_maj</a> ( account_number, <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400a8c9b47440bdc426dc6e11af2b2856792">BET_MAJ_ESTIMATE</a> );
<a name="l01436"></a>01436         <a class="code" href="bet__data_8c.html#af0bc501a6a7a255f8adc9500328c950f">bet_data_update_bet_module</a> ( account_number, <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> );
<a name="l01437"></a>01437     }
<a name="l01438"></a>01438 
<a name="l01439"></a>01439     <span class="keywordflow">return</span> FALSE;
<a name="l01440"></a>01440 }
<a name="l01441"></a>01441 
<a name="l01442"></a>01442 
<a name="l01449"></a><a class="code" href="bet__data_8h.html#ab7c4f2f8f73676c85d7b5b8412833c2d">01449</a> gboolean <a class="code" href="bet__data_8c.html#ab7c4f2f8f73676c85d7b5b8412833c2d">bet_data_future_remove_lines</a> ( gint account_number,
<a name="l01450"></a>01450                         gint number,
<a name="l01451"></a>01451                         gint mother_row )
<a name="l01452"></a>01452 {
<a name="l01453"></a>01453     GHashTableIter iter;
<a name="l01454"></a>01454     gpointer key, value;
<a name="l01455"></a>01455 
<a name="l01456"></a>01456     g_hash_table_iter_init ( &amp;iter, bet_future_list );
<a name="l01457"></a>01457     <span class="keywordflow">while</span> (g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) ) 
<a name="l01458"></a>01458     {
<a name="l01459"></a>01459         <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled = ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *) value;
<a name="l01460"></a>01460 
<a name="l01461"></a>01461         <span class="keywordflow">if</span> ( account_number != scheduled -&gt; account_number )
<a name="l01462"></a>01462         {
<a name="l01463"></a>01463             <span class="keywordflow">if</span> ( scheduled -&gt; is_transfert == 0
<a name="l01464"></a>01464              || ( scheduled -&gt; is_transfert &amp;&amp; account_number != scheduled -&gt; account_transfert ) )
<a name="l01465"></a>01465                 <span class="keywordflow">continue</span>;
<a name="l01466"></a>01466         }
<a name="l01467"></a>01467 
<a name="l01468"></a>01468         <span class="keywordflow">if</span> ( number == scheduled -&gt; number )
<a name="l01469"></a>01469             g_hash_table_iter_remove ( &amp;iter );
<a name="l01470"></a>01470         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( number == scheduled -&gt; mother_row )
<a name="l01471"></a>01471             g_hash_table_iter_remove ( &amp;iter );
<a name="l01472"></a>01472         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mother_row &gt; 0 &amp;&amp; mother_row == scheduled -&gt; number )
<a name="l01473"></a>01473             g_hash_table_iter_remove ( &amp;iter );
<a name="l01474"></a>01474         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mother_row &gt; 0 &amp;&amp; mother_row == scheduled -&gt; mother_row )
<a name="l01475"></a>01475             g_hash_table_iter_remove ( &amp;iter );
<a name="l01476"></a>01476     }
<a name="l01477"></a>01477 
<a name="l01478"></a>01478     <span class="keywordflow">if</span> ( <a class="code" href="parametres_8c.html#ab2a744f5d2124688473d13979420e911">etat</a>.<a class="code" href="structgsb__etat__t.html#a9d0fa9057da603e64a601d69d7bf2b51">modification_fichier</a> == 0 )
<a name="l01479"></a>01479         <a class="code" href="traitement__variables_8c.html#aa4084b9e508b1d1fea1d09c6b6208021">modification_fichier</a> ( TRUE );
<a name="l01480"></a>01480 
<a name="l01481"></a>01481     <span class="keywordflow">return</span> FALSE;
<a name="l01482"></a>01482 }
<a name="l01483"></a>01483 
<a name="l01484"></a>01484 
<a name="l01491"></a><a class="code" href="bet__data_8h.html#a0ad9a8f139c9c1fe907454b3130192c3">01491</a> GDate *<a class="code" href="bet__data_8c.html#a0ad9a8f139c9c1fe907454b3130192c3">bet_data_array_get_date_max</a> ( gint account_number )
<a name="l01492"></a>01492 {
<a name="l01493"></a>01493     GDate *date_min;
<a name="l01494"></a>01494     GDate *date_max;
<a name="l01495"></a>01495 
<a name="l01496"></a>01496     date_min = <a class="code" href="gsb__data__account_8c.html#a910ebbef9ceaf9559427c894531b8759">gsb_data_account_get_bet_start_date</a> ( account_number );
<a name="l01497"></a>01497 
<a name="l01498"></a>01498     date_max = <a class="code" href="utils__dates_8c.html#ad688d2e013a4c82fa7e1cb47f64054d4">gsb_date_copy</a> ( date_min );
<a name="l01499"></a>01499 
<a name="l01500"></a>01500     <span class="keywordflow">if</span> ( g_date_get_day ( date_min ) == 1 )
<a name="l01501"></a>01501     {
<a name="l01502"></a>01502         g_date_add_months (date_max, <a class="code" href="gsb__data__account_8c.html#a9f12538d67c1895d452f2958445862e6">gsb_data_account_get_bet_months</a> ( account_number ) - 1 );
<a name="l01503"></a>01503         date_max = <a class="code" href="utils__dates_8c.html#a72b939da505a26d0409317e4742af1f6">gsb_date_get_last_day_of_month</a> ( date_max );
<a name="l01504"></a>01504     }
<a name="l01505"></a>01505     <span class="keywordflow">else</span>
<a name="l01506"></a>01506     {
<a name="l01507"></a>01507         g_date_add_months (date_max, <a class="code" href="gsb__data__account_8c.html#a9f12538d67c1895d452f2958445862e6">gsb_data_account_get_bet_months</a> ( account_number ) );
<a name="l01508"></a>01508         g_date_subtract_days ( date_max, 1 );
<a name="l01509"></a>01509     }
<a name="l01510"></a>01510 
<a name="l01511"></a>01511     <span class="keywordflow">return</span> date_max;
<a name="l01512"></a>01512 }
<a name="l01513"></a>01513 
<a name="l01514"></a>01514 
<a name="l01521"></a><a class="code" href="bet__data_8h.html#aa5807c7bbe8349ad4e5d0377d897092d">01521</a> gboolean <a class="code" href="bet__data_8c.html#aa5807c7bbe8349ad4e5d0377d897092d">bet_data_future_modify_lines</a> ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled )
<a name="l01522"></a>01522 {
<a name="l01523"></a>01523     gchar *key;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525     <span class="keywordflow">if</span> ( scheduled -&gt; account_number == 0 )
<a name="l01526"></a>01526         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( scheduled -&gt; number ), NULL );
<a name="l01527"></a>01527     <span class="keywordflow">else</span>
<a name="l01528"></a>01528         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( scheduled -&gt; account_number ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l01529"></a>01529                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( scheduled -&gt; number ), NULL );
<a name="l01530"></a>01530 
<a name="l01531"></a>01531     g_hash_table_replace ( bet_future_list, key, scheduled );
<a name="l01532"></a>01532 
<a name="l01533"></a>01533     <span class="keywordflow">if</span> ( <a class="code" href="parametres_8c.html#ab2a744f5d2124688473d13979420e911">etat</a>.<a class="code" href="structgsb__etat__t.html#a9d0fa9057da603e64a601d69d7bf2b51">modification_fichier</a> == 0 )
<a name="l01534"></a>01534         <a class="code" href="traitement__variables_8c.html#aa4084b9e508b1d1fea1d09c6b6208021">modification_fichier</a> ( TRUE );
<a name="l01535"></a>01535 
<a name="l01536"></a>01536     <span class="keywordflow">return</span> TRUE;
<a name="l01537"></a>01537 }
<a name="l01538"></a>01538 
<a name="l01539"></a>01539 
<a name="l01546"></a><a class="code" href="bet__data_8h.html#aa5c30184255023ebcdf6c6234e6a989a">01546</a> <a class="code" href="struct__future__data.html">struct_futur_data</a> *<a class="code" href="bet__data_8c.html#aa5c30184255023ebcdf6c6234e6a989a">bet_data_future_get_struct</a> ( gint account_number, gint number )
<a name="l01547"></a>01547 {
<a name="l01548"></a>01548     gchar *key;
<a name="l01549"></a>01549     <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled;
<a name="l01550"></a>01550 
<a name="l01551"></a>01551     <span class="keywordflow">if</span> ( account_number == 0 )
<a name="l01552"></a>01552         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( number ), NULL );
<a name="l01553"></a>01553     <span class="keywordflow">else</span>
<a name="l01554"></a>01554         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( account_number ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l01555"></a>01555                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( number ), NULL );
<a name="l01556"></a>01556 
<a name="l01557"></a>01557     <span class="keywordflow">if</span> ( ( scheduled = g_hash_table_lookup ( bet_future_list, key ) ) )
<a name="l01558"></a>01558         <span class="keywordflow">return</span> scheduled;
<a name="l01559"></a>01559     <span class="keywordflow">else</span>
<a name="l01560"></a>01560         <span class="keywordflow">return</span> NULL;
<a name="l01561"></a>01561 }
<a name="l01562"></a>01562 
<a name="l01563"></a>01563 
<a name="l01570"></a><a class="code" href="bet__data_8h.html#abf90f0c52bc2bbdcc336f4956ace257f">01570</a> <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *<a class="code" href="bet__data_8c.html#abf90f0c52bc2bbdcc336f4956ace257f">struct_initialise_bet_transfert</a> ( <span class="keywordtype">void</span> )
<a name="l01571"></a>01571 {
<a name="l01572"></a>01572     <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert;
<a name="l01573"></a>01573 
<a name="l01574"></a>01574     transfert =  g_malloc0 ( <span class="keyword">sizeof</span> ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> ) );
<a name="l01575"></a>01575 
<a name="l01576"></a>01576     transfert -&gt; date = NULL;
<a name="l01577"></a>01577 
<a name="l01578"></a>01578     <span class="keywordflow">return</span> transfert;
<a name="l01579"></a>01579 }
<a name="l01580"></a>01580 
<a name="l01581"></a>01581 
<a name="l01588"></a>01588 <span class="keywordtype">void</span> struct_free_bet_transfert ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert )
<a name="l01589"></a>01589 {
<a name="l01590"></a>01590     <span class="keywordflow">if</span> ( transfert -&gt; date )
<a name="l01591"></a>01591         g_date_free ( transfert -&gt; date );
<a name="l01592"></a>01592 
<a name="l01593"></a>01593     g_free ( transfert );
<a name="l01594"></a>01594 }
<a name="l01595"></a>01595 
<a name="l01596"></a>01596 
<a name="l01603"></a><a class="code" href="bet__data_8h.html#a77e5c063714b4d86398084828d7b78eb">01603</a> GHashTable *<a class="code" href="bet__data_8c.html#a77e5c063714b4d86398084828d7b78eb">bet_data_transfert_get_list</a> ( <span class="keywordtype">void</span> )
<a name="l01604"></a>01604 {
<a name="l01605"></a>01605     <span class="keywordflow">return</span> bet_transfert_list;
<a name="l01606"></a>01606 }
<a name="l01607"></a>01607 
<a name="l01608"></a>01608 
<a name="l01615"></a><a class="code" href="bet__data_8h.html#ae27191a1ef681788491163590697b53f">01615</a> gboolean <a class="code" href="bet__data_8c.html#ae27191a1ef681788491163590697b53f">bet_data_transfert_add_line</a> ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert )
<a name="l01616"></a>01616 {
<a name="l01617"></a>01617     gchar *key;
<a name="l01618"></a>01618     
<a name="l01619"></a>01619     transfert_number ++;
<a name="l01620"></a>01620 
<a name="l01621"></a>01621     <span class="keywordflow">if</span> ( transfert -&gt; account_number == 0 )
<a name="l01622"></a>01622         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert_number ), NULL );
<a name="l01623"></a>01623     <span class="keywordflow">else</span>
<a name="l01624"></a>01624         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert -&gt; account_number ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l01625"></a>01625                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert_number ), NULL );
<a name="l01626"></a>01626 
<a name="l01627"></a>01627     transfert -&gt; number = transfert_number;
<a name="l01628"></a>01628     g_hash_table_insert ( bet_transfert_list, key, transfert );
<a name="l01629"></a>01629 
<a name="l01630"></a>01630     <span class="keywordflow">if</span> ( <a class="code" href="parametres_8c.html#ab2a744f5d2124688473d13979420e911">etat</a>.<a class="code" href="structgsb__etat__t.html#a9d0fa9057da603e64a601d69d7bf2b51">modification_fichier</a> == 0 )
<a name="l01631"></a>01631         <a class="code" href="traitement__variables_8c.html#aa4084b9e508b1d1fea1d09c6b6208021">modification_fichier</a> ( TRUE );
<a name="l01632"></a>01632 
<a name="l01633"></a>01633     <span class="keywordflow">return</span> TRUE;
<a name="l01634"></a>01634 }
<a name="l01635"></a>01635 
<a name="l01636"></a>01636 
<a name="l01643"></a><a class="code" href="bet__data_8h.html#a96f2da14ad123bdaca6976f33481166c">01643</a> gboolean <a class="code" href="bet__data_8c.html#a96f2da14ad123bdaca6976f33481166c">bet_data_transfert_remove_line</a> ( gint account_number, gint number )
<a name="l01644"></a>01644 {
<a name="l01645"></a>01645     GHashTableIter iter;
<a name="l01646"></a>01646     gpointer key, value;
<a name="l01647"></a>01647 
<a name="l01648"></a>01648     g_hash_table_iter_init ( &amp;iter, bet_transfert_list );
<a name="l01649"></a>01649     <span class="keywordflow">while</span> (g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) ) 
<a name="l01650"></a>01650     {
<a name="l01651"></a>01651         <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert = ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *) value;
<a name="l01652"></a>01652 
<a name="l01653"></a>01653         <span class="keywordflow">if</span> ( account_number != transfert -&gt; account_number 
<a name="l01654"></a>01654          ||
<a name="l01655"></a>01655          number != transfert -&gt; number)
<a name="l01656"></a>01656             <span class="keywordflow">continue</span>;
<a name="l01657"></a>01657 
<a name="l01658"></a>01658         g_hash_table_iter_remove ( &amp;iter );
<a name="l01659"></a>01659 
<a name="l01660"></a>01660         <span class="keywordflow">break</span>;
<a name="l01661"></a>01661     }
<a name="l01662"></a>01662 
<a name="l01663"></a>01663     <span class="keywordflow">if</span> ( <a class="code" href="parametres_8c.html#ab2a744f5d2124688473d13979420e911">etat</a>.<a class="code" href="structgsb__etat__t.html#a9d0fa9057da603e64a601d69d7bf2b51">modification_fichier</a> == 0 )
<a name="l01664"></a>01664         <a class="code" href="traitement__variables_8c.html#aa4084b9e508b1d1fea1d09c6b6208021">modification_fichier</a> ( TRUE );
<a name="l01665"></a>01665 
<a name="l01666"></a>01666     <a class="code" href="gsb__data__account_8c.html#aad11cfab16ac44e8de3dd6d792fce4cd">gsb_data_account_set_bet_maj</a> ( account_number, <a class="code" href="structures_8h.html#ab021d1439ce505d767a56f4fc41af400a8c9b47440bdc426dc6e11af2b2856792">BET_MAJ_ESTIMATE</a> );
<a name="l01667"></a>01667     <a class="code" href="bet__data_8c.html#af0bc501a6a7a255f8adc9500328c950f">bet_data_update_bet_module</a> ( account_number, <a class="code" href="fenetre__principale_8h.html#a42855d1b033e0c804c7e4e8ae8616520a64a555a792b2e49c42b925cad7bbc465">GSB_ESTIMATE_PAGE</a> );
<a name="l01668"></a>01668 
<a name="l01669"></a>01669     <span class="keywordflow">return</span> FALSE;
<a name="l01670"></a>01670 }
<a name="l01671"></a>01671 
<a name="l01672"></a>01672 
<a name="l01679"></a><a class="code" href="bet__data_8h.html#aa39d707af5ab5b7827ca29e9d4cd4d5c">01679</a> gboolean <a class="code" href="bet__data_8c.html#aa39d707af5ab5b7827ca29e9d4cd4d5c">bet_data_transfert_set_line_from_file</a> ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert )
<a name="l01680"></a>01680 {
<a name="l01681"></a>01681     gchar *key;
<a name="l01682"></a>01682 
<a name="l01683"></a>01683     <span class="keywordflow">if</span> ( transfert -&gt; account_number == 0 )
<a name="l01684"></a>01684         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert -&gt; number ), NULL );
<a name="l01685"></a>01685     <span class="keywordflow">else</span>
<a name="l01686"></a>01686         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert -&gt; account_number ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l01687"></a>01687                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert -&gt; number ), NULL );
<a name="l01688"></a>01688 
<a name="l01689"></a>01689     <span class="keywordflow">if</span> ( transfert -&gt; number &gt;  transfert_number )
<a name="l01690"></a>01690         transfert_number = transfert -&gt; number;
<a name="l01691"></a>01691 
<a name="l01692"></a>01692     g_hash_table_insert ( bet_transfert_list, key, transfert );
<a name="l01693"></a>01693 
<a name="l01694"></a>01694     <span class="keywordflow">return</span> TRUE;
<a name="l01695"></a>01695 }
<a name="l01696"></a>01696 
<a name="l01697"></a>01697 
<a name="l01704"></a><a class="code" href="bet__data_8h.html#ae6b517cdcf60d19b28ab333c4ff74d7b">01704</a> gboolean <a class="code" href="bet__data_8c.html#ae6b517cdcf60d19b28ab333c4ff74d7b">bet_data_transfert_modify_line</a> ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert )
<a name="l01705"></a>01705 {
<a name="l01706"></a>01706     gchar *key;
<a name="l01707"></a>01707 
<a name="l01708"></a>01708     <span class="keywordflow">if</span> ( transfert -&gt; account_number == 0 )
<a name="l01709"></a>01709         key = g_strconcat (<span class="stringliteral">&quot;0:&quot;</span>, <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert -&gt; number ), NULL );
<a name="l01710"></a>01710     <span class="keywordflow">else</span>
<a name="l01711"></a>01711         key = g_strconcat ( <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert -&gt; account_number ), <span class="stringliteral">&quot;:&quot;</span>,
<a name="l01712"></a>01712                         <a class="code" href="utils__str_8c.html#a1e50f3be459180b9dea9f14eb7e1204e" title="convert an integer into a gchar based string">utils_str_itoa</a> ( transfert -&gt; number ), NULL );
<a name="l01713"></a>01713 
<a name="l01714"></a>01714     g_hash_table_replace ( bet_transfert_list, key, transfert );
<a name="l01715"></a>01715 
<a name="l01716"></a>01716     <span class="keywordflow">if</span> ( <a class="code" href="parametres_8c.html#ab2a744f5d2124688473d13979420e911">etat</a>.<a class="code" href="structgsb__etat__t.html#a9d0fa9057da603e64a601d69d7bf2b51">modification_fichier</a> == 0 )
<a name="l01717"></a>01717         <a class="code" href="traitement__variables_8c.html#aa4084b9e508b1d1fea1d09c6b6208021">modification_fichier</a> ( TRUE );
<a name="l01718"></a>01718 
<a name="l01719"></a>01719     <span class="keywordflow">return</span> TRUE;
<a name="l01720"></a>01720 }
<a name="l01721"></a>01721 
<a name="l01722"></a>01722 
<a name="l01729"></a><a class="code" href="bet__data_8h.html#aaab5591eff8b758d7d53b3cc0e94f102">01729</a> <span class="keywordtype">void</span> <a class="code" href="bet__data_8c.html#aaab5591eff8b758d7d53b3cc0e94f102">bet_data_transfert_update_date_if_necessary</a> ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert )
<a name="l01730"></a>01730 {
<a name="l01731"></a>01731     GDate *date_jour_1;
<a name="l01732"></a>01732     GDate *tmp_date;
<a name="l01733"></a>01733 
<a name="l01734"></a>01734     date_jour_1 = <a class="code" href="utils__dates_8c.html#a6b816aab8b5dd412b89406bcc587738b">gdate_today</a> ( );
<a name="l01735"></a>01735     g_date_set_day ( date_jour_1, 1 );
<a name="l01736"></a>01736     tmp_date = <a class="code" href="utils__dates_8c.html#ad688d2e013a4c82fa7e1cb47f64054d4">gsb_date_copy</a> ( transfert -&gt; date );
<a name="l01737"></a>01737 
<a name="l01738"></a>01738     <span class="keywordflow">if</span> ( g_date_get_month ( date_jour_1 ) == g_date_get_month ( tmp_date ) )
<a name="l01739"></a>01739     {
<a name="l01740"></a>01740         g_date_free ( transfert -&gt; date );
<a name="l01741"></a>01741         g_date_add_months ( tmp_date, 1 );
<a name="l01742"></a>01742         transfert -&gt; date = tmp_date;
<a name="l01743"></a>01743     }
<a name="l01744"></a>01744 
<a name="l01745"></a>01745     g_date_free ( date_jour_1 );
<a name="l01746"></a>01746 }
<a name="l01747"></a>01747 
<a name="l01748"></a>01748 
<a name="l01755"></a><a class="code" href="bet__data_8h.html#a9dbd4a0c3a7673f2972be160d341dd93">01755</a> gboolean <a class="code" href="bet__data_8c.html#a9dbd4a0c3a7673f2972be160d341dd93">bet_data_remove_all_bet_data</a> ( gint account_number )
<a name="l01756"></a>01756 {
<a name="l01757"></a>01757     GHashTable *tmp_list;
<a name="l01758"></a>01758     GHashTableIter iter;
<a name="l01759"></a>01759     gpointer key, value;
<a name="l01760"></a>01760 
<a name="l01761"></a>01761     tmp_list = bet_hist_div_list;
<a name="l01762"></a>01762 
<a name="l01763"></a>01763     g_hash_table_iter_init ( &amp;iter, tmp_list );
<a name="l01764"></a>01764     <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) )
<a name="l01765"></a>01765     {
<a name="l01766"></a>01766         <a class="code" href="struct__hist__div.html">struct_hist_div</a> *shd = ( <a class="code" href="struct__hist__div.html">struct_hist_div</a> *) value;
<a name="l01767"></a>01767 
<a name="l01768"></a>01768         <span class="keywordflow">if</span> ( account_number != shd -&gt; account_nb )
<a name="l01769"></a>01769             <span class="keywordflow">continue</span>;
<a name="l01770"></a>01770 
<a name="l01771"></a>01771         <span class="keywordflow">if</span> ( g_hash_table_size ( shd -&gt; sub_div_list ) == 0 )
<a name="l01772"></a>01772         {
<a name="l01773"></a>01773             g_hash_table_iter_remove ( &amp;iter );
<a name="l01774"></a>01774             g_hash_table_iter_init ( &amp;iter, tmp_list );
<a name="l01775"></a>01775         }
<a name="l01776"></a>01776         <span class="keywordflow">else</span>
<a name="l01777"></a>01777         {
<a name="l01778"></a>01778             GHashTableIter new_iter;
<a name="l01779"></a>01779 
<a name="l01780"></a>01780             g_hash_table_iter_init ( &amp;new_iter, shd -&gt; sub_div_list );
<a name="l01781"></a>01781             <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;new_iter, &amp;key, &amp;value ) )
<a name="l01782"></a>01782             {
<a name="l01783"></a>01783                 g_hash_table_iter_remove ( &amp;new_iter );
<a name="l01784"></a>01784                 g_hash_table_iter_init ( &amp;new_iter, shd -&gt; sub_div_list );
<a name="l01785"></a>01785 
<a name="l01786"></a>01786                 <span class="keywordflow">if</span> ( g_hash_table_size ( shd -&gt; sub_div_list ) == 0 )
<a name="l01787"></a>01787                     <span class="keywordflow">break</span>;
<a name="l01788"></a>01788             }
<a name="l01789"></a>01789         }
<a name="l01790"></a>01790 
<a name="l01791"></a>01791         <span class="keywordflow">if</span> ( g_hash_table_size ( tmp_list ) == 0 )
<a name="l01792"></a>01792             <span class="keywordflow">break</span>;
<a name="l01793"></a>01793     }
<a name="l01794"></a>01794 
<a name="l01795"></a>01795     tmp_list = bet_future_list;
<a name="l01796"></a>01796 
<a name="l01797"></a>01797     g_hash_table_iter_init ( &amp;iter, tmp_list );
<a name="l01798"></a>01798     <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) )
<a name="l01799"></a>01799     {
<a name="l01800"></a>01800         <a class="code" href="struct__future__data.html">struct_futur_data</a> *scheduled = ( <a class="code" href="struct__future__data.html">struct_futur_data</a> *) value;
<a name="l01801"></a>01801 
<a name="l01802"></a>01802         <span class="keywordflow">if</span> ( account_number != scheduled -&gt; account_number )
<a name="l01803"></a>01803             <span class="keywordflow">continue</span>;
<a name="l01804"></a>01804 
<a name="l01805"></a>01805         <a class="code" href="bet__data_8c.html#ab7c4f2f8f73676c85d7b5b8412833c2d">bet_data_future_remove_lines</a> ( account_number, scheduled -&gt; number,
<a name="l01806"></a>01806                         scheduled -&gt; mother_row );
<a name="l01807"></a>01807         g_hash_table_iter_init ( &amp;iter, tmp_list );
<a name="l01808"></a>01808 
<a name="l01809"></a>01809         <span class="keywordflow">if</span> ( g_hash_table_size ( tmp_list ) == 0 )
<a name="l01810"></a>01810             <span class="keywordflow">break</span>;
<a name="l01811"></a>01811     }
<a name="l01812"></a>01812 
<a name="l01813"></a>01813      tmp_list = bet_transfert_list;
<a name="l01814"></a>01814 
<a name="l01815"></a>01815     g_hash_table_iter_init ( &amp;iter, tmp_list );
<a name="l01816"></a>01816     <span class="keywordflow">while</span> ( g_hash_table_iter_next ( &amp;iter, &amp;key, &amp;value ) )
<a name="l01817"></a>01817     {
<a name="l01818"></a>01818         <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *transfert = ( <a class="code" href="struct__transfert__data.html">struct_transfert_data</a> *) value;
<a name="l01819"></a>01819 
<a name="l01820"></a>01820         <span class="keywordflow">if</span> ( account_number != transfert -&gt; account_number )
<a name="l01821"></a>01821             <span class="keywordflow">continue</span>;
<a name="l01822"></a>01822 
<a name="l01823"></a>01823         g_hash_table_iter_remove ( &amp;iter );
<a name="l01824"></a>01824         g_hash_table_iter_init ( &amp;iter, tmp_list );
<a name="l01825"></a>01825 
<a name="l01826"></a>01826         <span class="keywordflow">if</span> ( g_hash_table_size ( tmp_list ) == 0 )
<a name="l01827"></a>01827             <span class="keywordflow">return</span> TRUE;
<a name="l01828"></a>01828     }
<a name="l01829"></a>01829    
<a name="l01830"></a>01830     <span class="keywordflow">return</span> TRUE;
<a name="l01831"></a>01831 }
<a name="l01832"></a>01832 
<a name="l01833"></a>01833 
<a name="l01834"></a>01834 <span class="comment">/* Local Variables: */</span>
<a name="l01835"></a>01835 <span class="comment">/* c-basic-offset: 4 */</span>
<a name="l01836"></a>01836 <span class="comment">/* End: */</span>
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Généré le Sat Aug 7 22:12:00 2010 pour Grisbi par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
