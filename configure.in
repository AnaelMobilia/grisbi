AC_INIT(src/main.c)

AM_INIT_AUTOMAKE(grisbi, 0.3.3 )
AM_CONFIG_HEADER(config.h)

AM_ACLOCAL_INCLUDE(macros)

AC_ISC_POSIX
AC_PROG_CC
AC_STDC_HEADERS

GNOME_INIT

GNOME_COMPILE_WARNINGS
GNOME_X_CHECKS
GNOME_XML_CHECK

AC_SUBST(prefix)

EXTRA_GNOME_LIBS=``
EXTRA_GNOME_CFLAGS=``

AC_SUBST(EXTRA_GNOME_LIBS)
AC_SUBST(EXTRA_GNOME_CFLAGS)

CFLAGS="$CFLAGS `$GNOME_CONFIG --cflags gnome gtk glib applets xml`"
LDFLAGS="$LDFLAGS `$GNOME_CONFIG --libs gnome gtk glib applets xml`"

AC_ARG_WITH(applet, [  --without-applet        No support for grisbi applet])

APPLET="false"
if test "$with_applet" != 'no' ; then
GNOME_CHECK_MODULES(GA, [ applets ],
		      [ APPLET=true; CFLAGS="$CFLAGS $GA_CFLAGS"; LDFLAGS="$LDFLAGS $GA_LIBS"; ],
		      [ AC_MSG_WARN(Gnome library Applets is not installed, I won't compile Grisbi applet) ] )
fi
AM_CONDITIONAL(APPLET, test $APPLET = true)

AC_SUBST(CFLAGS)
AC_SUBST(CPPFLAGS)
AC_SUBST(LDFLAGS)


dnl ******************************
dnl Makefiles
dnl ******************************

AC_OUTPUT([
Makefile
src/Makefile
applet/Makefile
help/Makefile
help/C/Makefile
macros/Makefile
])
